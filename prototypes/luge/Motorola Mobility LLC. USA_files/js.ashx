/*  Copyright 2009-2012 elicit, inc.
*   IMPORTANT NOTE: This file is licensed only for use in providing the elicit service,
*   or any part thereof, and is subject to the elicit Terms and Conditions. You may not
*   port this file to another platform without elicit's written consent. */
$elc.lib.loadJQueryPlugins=function($){(function(a,b,c){function g(a,c){var d=b.createElement(a||"div"),e;for(e in c){d[e]=c[e]}return d}function h(a){for(var b=1,c=arguments.length;b<c;b++){a.appendChild(arguments[b])}return a}function j(a,b,c,d){var g=["opacity",b,~~(a*100),c,d].join("-"),h=0.01+c/d*100,j=Math.max(1-(1-a)/b*(100-h),a),k=f.substring(0,f.indexOf("Animation")).toLowerCase(),l=k&&"-"+k+"-"||"";return e[g]||(i.insertRule("@"+l+"keyframes "+g+"{0%{opacity:"+j+"}"+h+"%{opacity:"+a+"}"+(h+0.01)+"%{opacity:1}"+(h+b)%100+"%{opacity:"+a+"}100%{opacity:"+j+"}}",0),e[g]=1),g}function k(a,b){var e=a.style,f,g;if(e[b]!==c){return b}b=b.charAt(0).toUpperCase()+b.slice(1);for(g=0;g<d.length;g++){f=d[g]+b;if(e[f]!==c){return f}}}function l(a,b){for(var c in b){a.style[k(a,c)||c]=b[c]}return a}function m(a){for(var b=1;b<arguments.length;b++){var d=arguments[b];for(var e in d){a[e]===c&&(a[e]=d[e])}}return a}function n(a){var b={x:a.offsetLeft,y:a.offsetTop};while(a=a.offsetParent){b.x+=a.offsetLeft,b.y+=a.offsetTop}return b}var d=["webkit","Moz","ms","O"],e={},f,i=function(){var a=g("style");return h(b.getElementsByTagName("head")[0],a),a.sheet||a.styleSheet}(),o={lines:12,length:7,width:5,radius:10,rotate:0,color:"#000",speed:1,trail:100,opacity:0.25,fps:20,zIndex:2000000000,className:"spinner",top:"auto",left:"auto"},p=function q(a){if(!this.spin){return new q(a)}this.opts=m(a||{},q.defaults,o)};p.defaults={},m(p.prototype,{spin:function(a){this.stop();var b=this,c=b.opts,d=b.el=l(g(0,{className:c.className}),{position:"relative",zIndex:c.zIndex}),e=c.radius+c.length+c.width,h,i;a&&(a.insertBefore(d,a.firstChild||null),i=n(a),h=n(d),l(d,{left:(c.left=="auto"?i.x-h.x+(a.offsetWidth>>1):c.left+e)+"px",top:(c.top=="auto"?i.y-h.y+(a.offsetHeight>>1):c.top+e)+"px"})),d.setAttribute("aria-role","progressbar"),b.lines(d,b.opts);if(!f){var j=0,k=c.fps,m=k/c.speed,o=(1-c.opacity)/(m*c.trail/100),p=m/c.lines;!function q(){j++;for(var a=c.lines;a;a--){var e=Math.max(1-(j+a*p)%m*o,c.opacity);b.opacity(d,c.lines-a,e,c)}b.timeout=b.el&&setTimeout(q,~~(1000/k))}()}return b},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=c),this},lines:function(a,b){function e(a,d){return l(g(),{position:"absolute",width:b.length+b.width+"px",height:b.width+"px",background:a,boxShadow:d,transformOrigin:"left",transform:"rotate("+~~(360/b.lines*c+b.rotate)+"deg) translate("+b.radius+"px,0)",borderRadius:(b.width>>1)+"px"})}var c=0,d;for(;c<b.lines;c++){d=l(g(),{position:"absolute",top:1+~(b.width/2)+"px",transform:b.hwaccel?"translate3d(0,0,0)":"",opacity:b.opacity,animation:f&&j(b.opacity,b.trail,c,b.lines)+" "+1/b.speed+"s linear infinite"}),b.shadow&&h(d,l(e("#000","0 0 4px #000"),{top:"2px"})),h(a,h(d,e(b.color,"0 0 1px rgba(0,0,0,.1)")))}return a},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}}),!function(){function a(a,b){return g("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',b)}var b=l(g("group"),{behavior:"url(#default#VML)"});!k(b,"transform")&&b.adj?(i.addRule(".spin-vml","behavior:url(#default#VML)"),p.prototype.lines=function(b,c){function f(){return l(a("group",{coordsize:e+" "+e,coordorigin:-d+" "+-d}),{width:e,height:e})}function k(b,e,g){h(i,h(l(f(),{rotation:360/c.lines*b+"deg",left:~~e}),h(l(a("roundrect",{arcsize:1}),{width:d,height:c.width,left:c.radius,top:-c.width>>1,filter:g}),a("fill",{color:c.color,opacity:c.opacity}),a("stroke",{opacity:0}))))}var d=c.length+c.width,e=2*d,g=-(c.width+c.length)*2+"px",i=l(f(),{position:"absolute",top:g,left:g}),j;if(c.shadow){for(j=1;j<=c.lines;j++){k(j,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)")}}for(j=1;j<=c.lines;j++){k(j)}return h(b,i)},p.prototype.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}):f=k(b,"animation")}(),a.Spinner=p})(window,document);$.fn.spin=function(opts,color){if(Spinner){return this.each(function(){var $this=$(this),data=$this.data();if(data.spinner){data.spinner.stop();delete data.spinner}if(opts!==false){data.spinner=new Spinner(opts).spin(this)}})}else{throw"Spinner class not available."}};$.fn.elcHint=function($settings){var settings={HINT_EVENT:"hintEvent.hint.elc",startLength:0,resultNum:4,maxLength:1000,hasSpinner:true,hasClearBtn:true,doesClearBtnPersist:false,enableEscape:false,enterOnKeyNav:false,enter:function(){},enterClearsHint:true,ignoreTabAndRightKeys:false,onClearGiveInputFocus:true,spinnerConfig:{color:"#888",lines:11,length:3,width:2,radius:3},useHintPlaceholderInput:false};$.extend(settings,$settings);if(settings.startLength<0){settings.startLength=0}if(settings.resultNum<0){settings.resultNum=0}var $this=$(this),$hintbox=$("<div class='elc-hint-container elc-pngfix '><div class='elc-hint-match'><span class='key'></span><span class='word'></span></div><div class='elc-hint-container-focus'></div></div>"),$hint_placeholder=$("<input type='text' class='elc-hint-placeholder' readOnly='readOnly' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' />");$resultsTable=$("<div class='elc-hint-results'><table><tbody></tbody></table></div>"),$icon=$("<div class='elc-hint-icon-container' contenteditable='false'><div class='loading'></div><div class='clear'></div></div>"),$spinner=null,$clearbtn=null,CLEAR_EVENT="clear.hint.elc",CANCEL_EVENT="cancel.hint.elc",KEY_NAV_EVENT="keynav.hint.elc",KEY_NAV_DOWN="down",KEY_NAV_UP="up",ESCAPE_EVENT="escape.hint.elc",$container=null,$containerFocus=null,$hint=null,$hint_key=null,$hint_word=null,$search=null,hasHitMaxLength=false,sindex=-1,tempkey="",isClickedHint=false,curHint="",allHints=[],spinnerDelayTimeout_id=-1,hintFadedUpAlready=true,now=new Date(),hintKey="",hintWord="",inputCaught=false,blurAssignTimeout_id=-1,isMobile=false,isAndroid=false,isLoggingEnabled=false;init();function init(){$this.removeClass("elc-hint");$this.addClass("elc-hint-search");$hintbox.append($this.clone());if(settings.resultNum!=0){$hintbox.append($resultsTable)}$this.val("");$this.replaceWith($hintbox);$container=$hintbox;$containerFocus=$container.find(".elc-hint-container-focus");$containerFocus.css("opacity",0);$hint=$(".elc-hint-match",$container);$hint_key=$(".elc-hint-match .key",$container);$hint_word=$(".elc-hint-match .word",$container);$search=$(".elc-hint-search",$container);var mytitle=$search.attr("title");if(mytitle==undefined){mytitle=""}$search.data("title",mytitle);$search.attr("title","");if(settings.useHintPlaceholderInput){$search.after($hint_placeholder);$hintbox.find(".elc-hint-match").remove()}$(".elc-hint-results",$container).css("top",$container.height());$search.attr("maxlength",settings.maxLength);$container.append($icon);$spinner=$(".loading",$icon);var $spin=$("<div class='spinjs'></div>").spin(settings.spinnerConfig);$spinner.append($spin);refreshViewWidths();setTimeout(function(){refreshViewWidths()},300);if($elc!=undefined){isMobile=$elc.util.isMobile()}isAndroid=navigator.userAgent.match(/Android/i);var bindContainerClick=true;$clearbtn=$(".clear",$icon);$spinner.unbind("click",spinnerClickHandler).bind("click",spinnerClickHandler);$clearbtn.unbind("click",clearClickHandler).bind("click",clearClickHandler);$container.unbind("mouseover",handleContainerMouseOver).bind("mouseover",handleContainerMouseOver);$container.unbind("mouseout",handleContainerMouseOut).bind("mouseout",handleContainerMouseOut);$search.unbind("focus",searchFocusHandler).bind("focus",searchFocusHandler);$search.unbind("input",handleInput).bind("input",handleInput);$search.unbind("keydown",handleKeyDown).bind("keydown",handleKeyDown);$search.unbind("keypress",handleKeyPress).bind("keypress",handleKeyPress);$search.unbind("keyup",handleKeyUp).bind("keyup",handleKeyUp);$search.unbind("cut paste",handleCutPaste).bind("cut paste",handleCutPaste);if(isMobile){bindContainerClick=false;$spinner.unbind("click",spinnerClickHandler);$clearbtn.unbind("click",clearClickHandler);$clearbtn.bind("touchstart",clearClickHandler).bind("touchend",terminateEvent);$spinner.bind("touchstart",spinnerClickHandler).bind("touchend",terminateEvent)}if(bindContainerClick){$container.click(function(e){if($elc!=undefined){if($elc.util.isMobile()){return}}if(!$search.is(":focus")){log("plugin container click - giving focus ");$search.focus()}})}$(".elc-hint-results table tbody td").die("click").live("click",clickHintResult);reset()}function reset(showFade){if($search.val()!=""){$search.val("");sindex=-1}var title=$search.data("title");if(title==undefined){title=""}setHintText("",title);hideIcons();hideResults()}function handleContainerMouseOver(event){$container.addClass("hovered")}function handleContainerMouseOut(event){$container.removeClass("hovered")}function searchFocusHandler(event){log("searchFocusHandler");handleKeyPress();giveContainerFocus(true);if($search.val()==$search.data("title")){$search.val("")}if(isIELess10()){}$search.unbind("blur",searchBlurHandler);clearTimeout(blurAssignTimeout_id);var delay=0;if(isAndroid){delay=50}blurAssignTimeout_id=setTimeout(function(){log("timeout - assign blur event handler");$search.bind("blur",searchBlurHandler)},delay)}function searchBlurHandler(event){clearTimeout(blurAssignTimeout_id);log("plugin blur visible:"+$search.is(":visible")+" hidden?"+$search.is(":hidden"));$search.unbind("blur",searchBlurHandler);giveContainerFocus(false);if($search.val()==""){reset(true)}}function giveContainerFocus(isFocused){if(isFocused==undefined){isFocused=false}log("giveContainerFocus:"+isFocused);var isDefaultText=hintWord==$search.data("title");if(isFocused){$container.addClass("elc-focused");$containerFocus.stop().animate({opacity:1},100)}else{$container.removeClass("elc-focused");$containerFocus.stop().animate({opacity:0},300)}}function removeContainerFocus(){log("removeContainerFocus");giveContainerFocus(false)}function terminateEvent(e){try{e.preventDefault();e.stopPropagation();e.stopImmediatePropagation()}catch(e){}}function getHintText(){var out=hintKey+hintWord;return out}function setHintText(key,word){if(settings.useHintPlaceholderInput){setHintPlaceholderText(key,word);return}log("plugin setHintText key:'"+key+"' word:'"+word+"'");hintKey=key.replace(/&nbsp;/g," ");hintWord=word.replace(/&nbsp;/g," ");var my=this,key_=key.replace(/ /g,"&nbsp;"),word_=word.replace(/ /g,"&nbsp;");$hint_word.removeClass("default");var myfunc=function(){$hint_key.html(key_);$hint_word.html(word_);if(isIE6()){if($elc!=undefined){$elc.util.redrawElement($container.parent())}}};if(word==$search.data("title")){setTimeout(myfunc,0);$hint_word.addClass("default")}else{myfunc()}var delayMS=isIE6()?0:300;if(!hintFadedUpAlready&&key==""&&word==$search.data("title")){$hint.stop().animate({opacity:0},0).animate({opacity:1},delayMS);hintFadedUpAlready=true}else{if(key!=""||word!=$search.data("title")){hintFadedUpAlready=false}}}function clearHintText(){log("clearHintText");setHintText("","")}function setHintPlaceholderText(key,word){log("plugin setHintText key:'"+key+"' word:'"+word+"'");hintKey=key.replace(/&nbsp;/g," ");hintWord=word.replace(/&nbsp;/g," ");var hintKey_=hintKey;var hintWord_=hintWord;var my=this,key_=key.replace(/ /g,"&nbsp;"),word_=word.replace(/ /g,"&nbsp;");$hint_placeholder.removeClass("default");var myfunc=function(){$hint_placeholder.val(hintKey_+hintWord_);if(isIE6()){if($elc!=undefined){$elc.util.redrawElement($container.parent())}}};if(word==$search.data("title")){setTimeout(myfunc,0);$hint_placeholder.addClass("default")}else{myfunc()}var delayMS=isIE6()?0:300;if(!hintFadedUpAlready&&key==""&&word==$search.data("title")){$hint.stop().animate({opacity:0},0).animate({opacity:1},delayMS);hintFadedUpAlready=true}else{if(key!=""||word!=$search.data("title")){hintFadedUpAlready=false}}}function handleInput(e){if(!isIELess10()){inputCaught=true;log("handleInput handler "+inputCaught);handleInputChanged()}}function handleCutPaste(e){if(!inputCaught){clearHintText();setTimeout(function(){syncWithInput()},0)}}function handleInputChanged(inputToAdd,bolSuppressHintEvent){log("handleInputChanged "+inputToAdd);if(bolSuppressHintEvent==undefined){bolSuppressHintEvent=false}if(inputToAdd==undefined){inputToAdd=""}if($search.val().length>=settings.maxLength&&hasHitMaxLength){return}if($search.val().length==0){reset(true)}tempkey=$search.val();showClearBtn(true);if(getHintText()==$search.data("title")){log("hint text same as title:"+$search.data("title"));clearHintText()}var key=(tempkey+inputToAdd);try{key=key.toLowerCase()}catch(e){}var hintHasInputVal=false;var hintText=getHintText();try{hintText=hintText.toLowerCase()}catch(e){}if(hintText.indexOf(key)==0){hintHasInputVal=true}log("hintText;"+hintText+" key:"+key+" index:"+hintText.indexOf(key));if(!hintHasInputVal&&settings.resultNum>0){var foundMatchInDropDown=false;var newMatchedHints=[];for(var i=0;i<allHints.length;i++){var myhint=allHints[i];if(myhint!=undefined&&myhint.toLowerCase().indexOf(key)==0){if(!foundMatchInDropDown){setHintText(key,myhint.substring(key.length))}newMatchedHints.push(myhint);foundMatchInDropDown=true}}showResults();updateHintResultsDropDown(key,newMatchedHints);if(!foundMatchInDropDown||allHints.length==0){log("found match indropdown || all hints.length 0");clearHintText();hideResults()}}else{if(!hintHasInputVal){log("!hint has input val");clearHintText()}else{var diffBetweenHintAndInput=$search.val().length;var total=hintKey+hintWord;setHintText(total.substr(0,diffBetweenHintAndInput),total.substr(diffBetweenHintAndInput,total.length));if(settings.resultNum>0){var newMatchedHints=[];for(var i in allHints){if(allHints[i].toLowerCase().indexOf(hintKey)==0){newMatchedHints.push(allHints[i])}}}}}log("$search.val().length:"+$search.val().length);if($search.val().length<settings.startLength){hideResults()}if(!bolSuppressHintEvent){setTimeout(function(){triggerGetHintEvent()},0)}}function handleKeyDown(event){if(event){var cc="";if(event.which!=""){cc=String.fromCharCode(event.which)}log("keydown - keycode:"+event.keyCode+"  which: "+event.which+"  char: "+cc+" $search.val:"+$search.val()+" event.ctrlKey:"+event.ctrlKey+" event.metaKey:"+event.metaKey+" blocker?"+isBlockerKey(event));if(event.keyCode==27){try{event.preventDefault();event.stopPropagation();event.stopImmediatePropagation()}catch(e){}return false}if(!settings.ignoreTabAndRightKeys){if(event.keyCode==9||event.keyCode==39){var fillout=handleFillInputWithHint();if(fillout){event.preventDefault();event.stopPropagation();event.stopImmediatePropagation()}return !fillout}}if(event.keyCode==13){onEnterHandler(event);return}if(event.keyCode==38){if(sindex>-1){sindex=sindex-1;$(".elc-hint-results table tr td.selected").removeClass("selected");$(".elc-hint-results table tr td").eq(sindex).addClass("selected");if(sindex==-1){var len=$(".elc-hint-results table tr td").length;sindex=(settings.resultNum<len)?settings.resultNum:len;$(".elc-hint-results table tr td.selected").removeClass("selected");$search.val(tempkey);log("keyup focus");$search.focus()}}else{$(".elc-hint-results table tr td.selected").removeClass("selected");sindex=-1}if($(".elc-hint-results table tr td").length>0){event.preventDefault();selectKeyedResult();$search.trigger({type:KEY_NAV_EVENT,key:KEY_NAV_UP});if(settings.enterOnKeyNav){settings.enter()}}if(settings.resultNum==0){$search.trigger({type:KEY_NAV_EVENT,key:KEY_NAV_UP})}try{event.preventDefault();event.stopPropagation();event.stopImmediatePropagation()}catch(er){}return false}if(event.keyCode==40){if($(".elc-hint-results").css("display")=="none"&&$(".elc-hint-results table tr td").length>0){showResults();sindex=-1;return}if($(".elc-hint-results table tr td").length>0){sindex=sindex+1;if($(".elc-hint-results table tr td.selected").length==0){tempkey=$search.val()}$(".elc-hint-results table tr td.selected").removeClass("selected");$(".elc-hint-results table tr td").eq(sindex).addClass("selected");selectKeyedResult();$search.trigger({type:KEY_NAV_EVENT,key:KEY_NAV_DOWN});if(settings.enterOnKeyNav){settings.enter()}}if(sindex>=settings.resultNum||sindex>=$(".elc-hint-results table tr td").length){sindex=-1;$(".elc-hint-results table tr td.selected").removeClass("selected");$search.val(tempkey);$search.focus();setHintText(tempkey,$(".elc-hint-results table tr td span.word:first").html())}if(settings.resultNum==0){$search.trigger({type:KEY_NAV_EVENT,key:KEY_NAV_DOWN})}try{event.preventDefault();event.stopPropagation();event.stopImmediatePropagation()}catch(er){}return false}if(!inputCaught&&event.keyCode==8){setTimeout(function(){log("delete press");handleInputChanged(undefined,true)},0)}}}function handleKeyPress(event){if(event){var cc="";if(event.which!=""){cc=String.fromCharCode(event.which)}log("keypress - keycode:"+event.keyCode+"  which: "+event.which+"  char: "+cc+" $search.val:"+$search.val()+" event.ctrlKey:"+event.ctrlKey+" event.metaKey:"+event.metaKey+" blocker?"+isBlockerKey(event)+" inputChangeIsPartOfHint:"+event.inputChangeIsPartOfHint);if(event.keyCode==27){try{event.preventDefault();event.stopPropagation();event.stopImmediatePropagation()}catch(e){}return false}if(isBlockerKey(event)){return true}setTimeout(function(){if(!inputCaught&&(event.which>47||event.which==32)){log("input not caught in keypress.. inputCaught:"+inputCaught);handleInputChanged()}},0)}}function handleKeyUp(event){if(isBlockerKey(event)){return true}if(event.keyCode==27){try{event.preventDefault();event.stopPropagation();event.stopImmediatePropagation()}catch(e){}var hasResults=(settings.resultNum!=0&&($(".elc-hint-results").css("display")=="block"));if(settings.enableEscape){if(!hasResults){tempkey="";setHintText("",$search.data("title"));$search.val("");hideResults();sindex=-1;hideIcons();$search.trigger(CLEAR_EVENT);$search.blur();$search.focus();log("trigger escae focus settings.onClearGiveInputFocus "+settings.onClearGiveInputFocus)}else{$(".elc-hint-results").hide();$search.blur();$search.focus();log("results trigger escae focus settings.onClearGiveInputFocus "+settings.onClearGiveInputFocus)}}$search.trigger(ESCAPE_EVENT,hasResults);return false}if(event.keyCode==8){if(!inputCaught){handleInputChanged()}return true}if(!inputCaught&&event.keyCode>47||event.keyCode==32){return true}}function onEnterHandler(e){var bolInputFilledWithHint=false;if(settings.enterClearsHint){log("enter handler clear text");clearHintText()}sindex=-1;selectKeyedResult();hideResults();try{e.preventDefault();e.stopPropagation();e.stopImmediatePropagation()}catch(err){}settings.enter(e);return false}function isBlockerKey(event){var out=false;if(event){out=event.ctrlKey==true||event.altKey==true||(event.metaKey!=undefined&&event.metaKey==true)||event.keyCode==224||event.keyCode==91||event.keyCode==92||event.keyCode==93}return out}function triggerGetHintEvent(bolInputFilledWithHint){if(bolInputFilledWithHint==undefined){bolInputFilledWithHint=false}var hint_out_event=$.Event(settings.HINT_EVENT,{bolInputFilledWithHint:bolInputFilledWithHint});log("triggerGetHintEvent: bolInputFilledWithHint:"+bolInputFilledWithHint+" $search.val(): "+$search.val());if(allHints[0]&&allHints[0].indexOf($search.val())!=0){log("ie selection start issue");hideResults();clearHintText()}if($search.val().length>=settings.maxLength&&hasHitMaxLength){return}else{if($search.val().length>=settings.maxLength){hasHitMaxLength=true}else{hasHitMaxLength=false}}if($.trim($search.val()).length==0){reset(true)}else{showSpinner()}$search.trigger(hint_out_event)}function syncWithInput(){log("syncWithInput");setKey($search.val())}function setKey(s,keyCode){log("setkey "+s);$search.val(s);handleInputChanged()}function handleFillInputWithHint(){var bolInputFilledWithHint=false;var hintText=getHintText();if(getHintText()!=""&&$search.val()!=""&&getHintText()!=$search.val()){log("handleFillInputWithHint: '"+getHintText()+"'");bolInputFilledWithHint=true;$search.val(getHintText());setHintText(getHintText(),"");hideResults();sindex=-1;tempkey="";$search.focus();triggerGetHintEvent(bolInputFilledWithHint)}return bolInputFilledWithHint}function fillInputWithHint(){return handleFillInputWithHint()}function showSpinner(bool,bolBypassDelayCheck){log("showspinner "+bool+" bolBypassDelayCheck:"+bolBypassDelayCheck+" spinnerDelayTimeout_id:"+spinnerDelayTimeout_id);if(!settings.hasSpinner){return}if(bool==undefined){bool=true}if(bolBypassDelayCheck==undefined){bolBypassDelayCheck=false}if(bool==false){bolBypassDelayCheck=true}clearTimeout(spinnerDelayTimeout_id);spinnerDelayTimeout_id=-1;if(bool==true&&bolBypassDelayCheck==false){spinnerDelayTimeout_id=setTimeout(function(){showSpinner(bool,true)},250);return}var dealyMS=isIE6()?0:200;if(bool&&$search.val()!=""){showClearBtn(false);$icon.show();if(settings.hasSpinner){$spinner.stop(true,true).fadeIn(dealyMS)}}else{$spinner.stop(true,true).fadeOut(dealyMS);$icon.hide()}if(isIE6()){$icon.show();$spinner.parent().hide().delay(500).show()}}function spinnerClickHandler(e){showSpinner(false);$search.trigger(CANCEL_EVENT)}function showClearBtn(bool){if(bool==undefined){bool=true}var dealyMS=isIE6()||isMobile?0:200;if(bool){showSpinner(false);$icon.show();if(settings.hasClearBtn){$clearbtn.stop(true,true).fadeIn(dealyMS)}}else{if(settings.doesClearBtnPersist){return}$clearbtn.stop(true,true).fadeOut(dealyMS);$icon.hide()}if(isIE6()){$clearbtn.parent().hide().delay(500).show();$icon.show()}}function hideIcons(){log("hide spinner from hideIcons");showSpinner(false);if(settings.doesClearBtnPersist){showClearBtn(true)}else{showClearBtn(false)}}function clearClickHandler(e){var inputHadValue=$search.val()!="";log("clearClickHandler settings.onClearGiveInputFocus:"+settings.onClearGiveInputFocus+" focused?"+$search.is(":focus")+" inputHadValue:"+inputHadValue);reset(true);var ce=new $.Event(CLEAR_EVENT);ce.inputHadValue=inputHadValue;$search.trigger(ce);if(settings.onClearGiveInputFocus&&inputHadValue){$search.focus();log("trigger escae focus")}else{$search.blur();e.preventDefault();e.stopPropagation()}}function refreshViewWidths(){$search.width($container.innerWidth());$hint.width($container.innerWidth());var iconContainerWidth=$(".elc-hint-icon-container").outerWidth(true)+2;if($elc!=undefined&&$elc.config.get("determineSearchInputPaddingRight")!=null){var variableWidth=$elc.config.get("determineSearchInputPaddingRight")($search,iconContainerWidth);$search.width($container.innerWidth()-variableWidth)}else{var isLegacy=document.compatMode=="BackCompat"||document.compatMode=="CSS1 Compat";if(!isLegacy){var targetWidth=$container.innerWidth();targetWidth-=iconContainerWidth;if(!isNaN(parseInt($search.css("left")))){targetWidth-=parseInt($search.css("left"))}if(isAndroid){}$search.width(targetWidth)}}$hint.width($search.width());if(settings.useHintPlaceholderInput){$hint_placeholder.width($search.innerWidth())}if($elc!=undefined&&$elc.config.get("useAutoHintPositioning")!=undefined&&$elc.config.get("useAutoHintPositioning")){positionHint($hint,$search)}}
/*
		* HTML5 placeholder polyfill
		* @requires jQuery - tested with 1.6.2 but might as well work with older versions
		* 
		* code: https://github.com/ginader/HTML5-placeholder-polyfill
		* please report issues at: https://github.com/ginader/HTML5-placeholder-polyfill/issues
		*
		* Copyright (c) 2012 Dirk Ginader (ginader.de)
		* Dual licensed under the MIT and GPL licenses:
		* http://www.opensource.org/licenses/mit-license.php
		* http://www.gnu.org/licenses/gpl.html
		*
		* Version: 2.0
		*/
function positionHint(placeholder,input){var ta=input.is("textarea");placeholder.css({width:input.innerWidth()-(ta?20:4),height:input.innerHeight()-6,lineHeight:input.css("line-height"),whiteSpace:ta?"normal":"nowrap",overflow:"hidden"}).offset(input.offset())}function showResults(){$(".elc-hint-results").show();showClearBtn()}function hideResults(){$(".elc-hint-results").hide();$(".elc-hint-results table tbody").empty()}function clickHintResult(event){event.preventDefault();var $this=$(this);log("click handler result");clearHintText();$search.val($search.data("title"));hideResults();isClickedHint=true;$search.trigger(settings.HINT_EVENT)}function selectKeyedResult(){if($(".elc-hint-results table td.selected").length>0){$search.val($(".elc-hint-results table td.selected").attr("title"));log("selectKeyedResult");clearHintText()}}function hasSameNextLetterAsHint(search){if(!search){return false}var myhint=getHintText();var out="";try{out=myhint.toLowerCase().indexOf(search.toLowerCase())>-1}catch(e){}return out}function updateHintResultsDropDown(key,hints){if(hints&&hints.length>0&&key&&key!=""){$(".elc-hint-results table tbody").empty();for(var i in hints){if(i>=settings.resultNum){break}var word=hints[i].substring(key.length);$(".elc-hint-results table tbody").append("<tr><td title='"+key+word+"'><span class='key'>"+key+"</span><span class='word'>"+word+"</span></td></tr>")}if(!isClickedHint){showResults()}else{isClickedHint=false}}else{hideResults()}}function log(s){if(isLoggingEnabled){var logDate=new Date(),diff=logDate.getTime()-now.getTime();try{console.log("[ELC-HINT "+diff+"] "+s)}catch(e){}}}var _isIELess10=null;function isIELess10(){if(_isIELess10!=null){return _isIELess10}_isIELess10=((/msie 6./i).test(navigator.appVersion)||(/msie 7./i).test(navigator.appVersion)||(/msie 8./i).test(navigator.appVersion)||(/msie 9./i).test(navigator.appVersion))&&(window.ActiveXObject!=undefined);return _isIELess10}var _isIE6=null;function isIE6(){if(_isIE6!=null){return _isIE6}_isIE6=!!(document.all&&(/msie 6./i).test(navigator.appVersion)&&(window.ActiveXObject!=undefined));return _isIE6}return{HINT_EVENT:settings.HINT_EVENT,KEY_NAV_EVENT:KEY_NAV_EVENT,KEY_NAV_DOWN:KEY_NAV_DOWN,KEY_NAV_UP:KEY_NAV_UP,CLEAR_EVENT:CLEAR_EVENT,CANCEL_EVENT:CANCEL_EVENT,ESCAPE_EVENT:ESCAPE_EVENT,inputbox:$search,setKey:setKey,getKey:function(){return $search.val()},getHint:function(){return curHint},setHint:function(hint){if(hint!=undefined&&hint!=null){log("external setHint:'"+hint+"'");curHint=hint;var hint_word=hint.substring($search.val().length);var searchVal=$search.val();if(hint==""){searchVal="";hint_word=""}setHintText(searchVal,hint_word);showClearBtn()}},reset:reset,setHintResults:function(hints){allHints=hints;var key=$search.val();if(key!=""&&hints[0]){if(getHintText()==""){var hint_word=hints[0].substring(key.length);setHintText(key,hint_word)}if(!hasSameNextLetterAsHint(hints[0])){var hint_word=hints[0].substring(key.length);setHintText(key,hint_word)}else{var hint_word=hints[0].substring(key.length);setHintText(key,hint_word)}updateHintResultsDropDown(key,hints);showClearBtn()}else{if(key!=""){showClearBtn()}}},showSpinner:function(bool){showSpinner(bool)},showClearBtn:function(bool){showClearBtn(bool)},hideIcons:function(){hideIcons()},fillInputWithHint:fillInputWithHint,refreshViewWidths:refreshViewWidths}};
/*
	*
	* Copyright (c) 2010 C. F., Wong (<a href="http://cloudgen.w0ng.hk">Cloudgen Examplet Store</a>)
	* http://www.jquery-plugin.buss.hk/my-plugins/jquery-caret-plugin
	*  Licensed under the MIT License:
	* http://www.opensource.org/licenses/mit-license.php
	*
	*/
(function($,len,createRange,duplicate){$.fn.caret=function(options,opt2){var start,end,t=this[0],browser=$.browser.msie;if(typeof options==="object"&&typeof options.start==="number"&&typeof options.end==="number"){start=options.start;end=options.end}else{if(typeof options==="number"&&typeof opt2==="number"){start=options;end=opt2}else{if(typeof options==="string"){if((start=t.value.indexOf(options))>-1){end=start+options[len]}else{start=null}}else{if(Object.prototype.toString.call(options)==="[object RegExp]"){var re=options.exec(t.value);if(re!=null){start=re.index;end=start+re[0][len]}}}}}if(typeof start!="undefined"){if(browser){var selRange=this[0].createTextRange();selRange.collapse(true);selRange.moveStart("character",start);selRange.moveEnd("character",end-start);selRange.select()}else{this[0].selectionStart=start;this[0].selectionEnd=end}this[0].focus();return this}else{if(browser){var selection=document.selection;if(this[0].tagName.toLowerCase()!="textarea"){var val=this.val(),range=selection[createRange]()[duplicate]();range.moveEnd("character",val[len]);var s=(range.text==""?val[len]:val.lastIndexOf(range.text));range=selection[createRange]()[duplicate]();range.moveStart("character",-val[len]);var e=range.text[len]}else{var range=selection[createRange](),stored_range=range[duplicate]();stored_range.moveToElementText(this[0]);stored_range.setEndPoint("EndToEnd",range);var s=stored_range.text[len]-range.text[len],e=s+range.text[len]}}else{var s=t.selectionStart,e=t.selectionEnd}var te=t.value.substring(s,e);return{start:s,end:e,text:te,replace:function(st){return t.value.substring(0,s)+st+t.value.substring(e,t.value[len])}}}}})($,"len","createRange","duplicate");
/*
	* jQuery Cookie Plugin
	* https://github.com/carhartl/jquery-cookie
	*
	* Copyright 2011, Klaus Hartl
	* Dual licensed under the MIT or GPL Version 2 licenses.
	* http://www.opensource.org/licenses/mit-license.php
	* http://www.opensource.org/licenses/GPL-2.0
	*/
$.cookie=function(key,value,options){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(value))||value===null||value===undefined)){options=$.extend({},options);if(value===null||value===undefined){options.expires=-1}if(typeof options.expires==="number"){var days=options.expires,t=options.expires=new Date();t.setDate(t.getDate()+days)}value=String(value);return(document.cookie=[encodeURIComponent(key),"=",options.raw?value:encodeURIComponent(value),options.expires?"; expires="+options.expires.toUTCString():"",options.path?"; path="+options.path:"",options.domain?"; domain="+options.domain:"",options.secure?"; secure":""].join(""))}options=value||{};var decode=options.raw?function(s){return s}:decodeURIComponent;var pairs=document.cookie.split("; ");for(var i=0,pair;pair=pairs[i]&&pairs[i].split("=");i++){if(decode(pair[0])===key){return decode(pair[1]||"")}}return null};
/*
	@title:
	Center

	@version:
	2.0

	@author:
	Andreas Lagerkvist

	@date:
	2008-09-17

	@url:
	http://andreaslagerkvist.com/jquery/center/

	@license:
	http://creativecommons.org/licenses/by/3.0/

	@copyright:
	2008 Andreas Lagerkvist (andreaslagerkvist.com)

	@requires:
	jquery

	@does:
	This little pluggy centers an element on the screen using either fixed or absolute positioning. Can be used to display messages, pop up images etc.

	@howto:
	jQuery('#my-element').center(true); would center the element with ID 'my-element' using absolute position (leave empty for fixed).

	@exampleHTML:
	<p>I should be fixed centered</p>

	<p>The paragraph above and the paragraph beneath this one are centered. They should be in the middle of the viewport.</p>

	<p>I should be absolutely centered</p>

	@exampleJS:
	jQuery('#jquery-center-example p:first-child').center();
	jQuery('#jquery-center-example p:last-child').center(true);
	*/
$.fn.center=function(absolute){return this.each(function(){var t=jQuery(this);t.css({position:absolute?"absolute":"fixed",left:"50%",top:"50%",zIndex:"99"}).css({marginLeft:"-"+(t.outerWidth()/2)+"px",marginTop:"-"+(t.outerHeight()/2)+"px"});if(absolute){t.css({marginTop:parseInt(t.css("marginTop"),10)+jQuery(window).scrollTop(),marginLeft:parseInt(t.css("marginLeft"),10)+jQuery(window).scrollLeft()})}})};$.fn.extend({disableSelection:function(){this.each(function(){if(typeof this.onselectstart!="undefined"){this.onselectstart=function(){return false}}else{if(typeof this.style.MozUserSelect!="undefined"){this.style.MozUserSelect="none"}else{this.onmousedown=function(){return false}}}})}});
/*
	* Force Redraw
	*
	* Created by Pascal Beyeler (anvio.ch)
	* Dual licensed under the MIT and GPL licenses:
	* http://www.opensource.org/licenses/mit-license.php
	* http://www.gnu.org/licenses/gpl.html
	*
	*/
(function($){$.fn.forceRedraw=function(brutal){$(this).addClass("forceRedraw").removeClass("forceRedraw");if(brutal){var paddingLeft=$(this).css("padding-left");var parsedPaddingLeft=parseInt(paddingLeft,10);$(this).css("padding-left",++parsedPaddingLeft);window.setTimeout($.proxy(function(){$(this).css("padding-left",paddingLeft)},this),1)}};$.fn.textWidth=function(){var html_org=$(this).html();var html_calc="<span>"+html_org+"</span>";$(this).html(html_calc);var width=$(this).find("span:first").width();$(this).html(html_org);return width};$.fn.textHeight=function(){var html_org=$(this).html();var html_calc="<span>"+html_org+"</span>";$(this).html(html_calc);var height=$(this).find("span:first").height();$(this).html(html_org);return height}})($);
/*
	* jQuery resize event - v1.1 - 3/14/2010
	* http://benalman.com/projects/jquery-resize-plugin/
	* 
	* Copyright (c) 2010 "Cowboy" Ben Alman
	* Dual licensed under the MIT and GPL licenses.
	* http://benalman.com/about/license/
	*/
(function($,window,undefined){var elems=$([]),jq_resize=$.resize=$.extend($.resize,{}),timeout_id,str_setTimeout="setTimeout",str_resize="resize",str_data=str_resize+"-special-event",str_delay="delay",str_throttle="throttleWindow";jq_resize[str_delay]=250;jq_resize[str_throttle]=true;$.event.special[str_resize]={setup:function(){if(!jq_resize[str_throttle]&&this[str_setTimeout]){return false}var elem=$(this);elems=elems.add(elem);$.data(this,str_data,{w:elem.width(),h:elem.height()});if(elems.length===1){loopy()}},teardown:function(){if(!jq_resize[str_throttle]&&this[str_setTimeout]){return false}var elem=$(this);elems=elems.not(elem);elem.removeData(str_data);if(!elems.length){clearTimeout(timeout_id)}},add:function(handleObj){if(!jq_resize[str_throttle]&&this[str_setTimeout]){return false}var old_handler;function new_handler(e,w,h){var elem=$(this),data=$.data(this,str_data);data.w=w!==undefined?w:elem.width();data.h=h!==undefined?h:elem.height();old_handler.apply(this,arguments)}if($.isFunction(handleObj)){old_handler=handleObj;return new_handler}else{old_handler=handleObj.handler;handleObj.handler=new_handler}}};function loopy(){timeout_id=window[str_setTimeout](function(){elems.each(function(){var elem=$(this),width=elem.width(),height=elem.height(),data=$.data(this,str_data);if(width!==data.w||height!==data.h){elem.trigger(str_resize,[data.w=width,data.h=height])}});loopy()},jq_resize[str_delay])}})($,window);
/*
	Copyright (c) 2010 C. F., Wong (<a href="http://cloudgen.w0ng.hk">Cloudgen Examplet Store</a>)
	Licensed under the MIT License:
	http://www.opensource.org/licenses/mit-license.php
	http://www.jquery-plugin.buss.hk/my-plugins/jquery-caret-plugin
	*/
(function($,len,createRange,duplicate){$.fn.caret=function(options,opt2){var start,end,t=this[0],browser=$.browser.msie;if(typeof options==="object"&&typeof options.start==="number"&&typeof options.end==="number"){start=options.start;end=options.end}else{if(typeof options==="number"&&typeof opt2==="number"){start=options;end=opt2}else{if(typeof options==="string"){if((start=t.value.indexOf(options))>-1){end=start+options[len]}else{start=null}}else{if(Object.prototype.toString.call(options)==="[object RegExp]"){var re=options.exec(t.value);if(re!=null){start=re.index;end=start+re[0][len]}}}}}if(typeof start!="undefined"){if(browser){var selRange=this[0].createTextRange();selRange.collapse(true);selRange.moveStart("character",start);selRange.moveEnd("character",end-start);selRange.select()}else{this[0].selectionStart=start;this[0].selectionEnd=end}this[0].focus();return this}else{if(browser){var selection=document.selection;if(this[0].tagName.toLowerCase()!="textarea"){var val=this.val(),range=selection[createRange]()[duplicate]();range.moveEnd("character",val[len]);var s=(range.text==""?val[len]:val.lastIndexOf(range.text));range=selection[createRange]()[duplicate]();range.moveStart("character",-val[len]);var e=range.text[len]}else{var range=selection[createRange](),stored_range=range[duplicate]();stored_range.moveToElementText(this[0]);stored_range.setEndPoint("EndToEnd",range);var s=stored_range.text[len]-range.text[len],e=s+range.text[len]}}else{var s=t.selectionStart,e=t.selectionEnd}var te=t.value.substring(s,e);return{start:s,end:e,text:te,replace:function(st){return t.value.substring(0,s)+st+t.value.substring(e,t.value[len])}}}}})($,"length","createRange","duplicate");$.fn.getBgWidthHeight=function(){var height=0,width=0,bgImg=$(this).css("background-image");if(bgImg!=undefined&&bgImg!="none"){var path=bgImg.replace("url","").replace("(","").replace(")","").replace('"',"").replace('"',"");var tempImg='<img id="tempImg" src="'+path+'"/>';$("body").append(tempImg);$("#tempImg").hide();height=$("#tempImg").height();width=$("#tempImg").width();$("#tempImg").remove()}return{height:height,width:width}};
/*
	* jQote2 - client-side Javascript templating engine
	* Copyright (C) 2010, aefxx
	* http://aefxx.com/
	*
	* Dual licensed under the WTFPL v2 or MIT (X11) licenses
	* WTFPL v2 Copyright (C) 2004, Sam Hocevar
	*
	* Date: Thu, Oct 21st, 2010
	* Version: 0.9.7
	*/
(function($){var _=false,E1="UndefinedTemplateError",E2="TemplateCompilationError",E3="TemplateExecutionError",A="[object Array]",S="[object String]",F="[object Function]",n=1,c="%",q=/^[^<]*(<[\w\W]+>)[^>]*$/,ts=Object.prototype.toString;function r(e,x){throw ($.extend(e,x),e)}function dns(f){var a=[];if(ts.call(f)!==A){return _}for(var i=0,l=f.length;i<l;i++){a[i]=f[i].jqote_id}return a.length?a.sort().join(".").replace(/(\b\d+\b)\.(?:\1(\.|$))+/g,"$1$2"):_}function l(s,t){var f,g=[],t=t||c,x=ts.call(s);if(x===F){return s.jqote_id?[s]:_}if(x!==A){return[$.jqotec(s,t)]}if(x===A){for(var i=0,l=s.length;i<l;i++){return g.length?g:_}}}$.fn.extend({jqote:function(x,y){var x=ts.call(x)===A?x:[x],d="";this.each(function(i){var f=$.jqotec(this,y);for(var j=0;j<x.length;j++){d+=f.call(x[j],i,j,x,f)}});return d}});$.each({app:"append",pre:"prepend",sub:"html"},function(x,y){$.fn["jqote"+x]=function(e,d,t){var p,r,s=$.jqote(e,d,t),$$=!q.test(s)?function(s){return $(document.createTextNode(s))}:$;if(!!(p=dns(l(e)))){r=new RegExp("(^|\\.)"+p.split(".").join("\\.(.*)?")+"(\\.|$)")}return this.each(function(){var z=$$(s);$(this)[y](z);(z[0].nodeType===3?$(this):z).trigger("jqote."+x,[z,r])})}});$.extend({jqote:function(e,d,t){var s="",t=t||c,f=l(e);if(f===_){r(new Error("Empty or undefined template passed to $.jqote"),{type:E1})}d=ts.call(d)!==A?[d]:d;for(var i=0,m=f.length;i<m;i++){for(var j=0;j<d.length;j++){s+=f[i].call(d[j],i,j,d,f[i])}}return s},jqotec:function(x,t){var h,e,y,t=t||c,z=ts.call(x);if(z===S&&q.test(x)){e=y=x;if(h=$.jqotecache[x]){return h}}else{e=z===S||x.nodeType?$(x):x instanceof jQuery?x:null;if(!e[0]||!(y=e[0].innerHTML)&&!(y=e.text())){r(new Error("Empty or undefined template passed to $.jqotec"),{type:E1})}if(h=$.jqotecache[$.data(e[0],"jqote_id")]){return h}}var s="",i,a=y.replace(/\s*<!\[CDATA\[\s*|\s*\]\]>\s*|[\r\n\t]/g,"").split("<"+t).join(t+">\x1b").split(t+">");for(var m=0,k=a.length;m<k;m++){s+=a[m].charAt(0)!=="\x1b"?"out+='"+a[m].replace(/(\\|["'])/g,"\\$1")+"'":(a[m].charAt(1)==="="?";out+=("+a[m].substr(2)+");":(a[m].charAt(1)==="!"?";out+=$.jqotenc(("+a[m].substr(2)+"));":";"+a[m].substr(1)))}s="try{"+('var out="";'+s+";return out;").split("out+='';").join("").split('var out="";out+=').join("var out=")+'}catch(e){e.type="'+E3+'";e.args=arguments;e.template=arguments.callee.toString();throw e;}';try{var f=new Function("i, j, data, fn",s)}catch(e){r(e,{type:E2})}i=e instanceof jQuery?$.data(e[0],"jqote_id",n):e;return $.jqotecache[i]=(f.jqote_id=n++,f)},jqotefn:function(e){var t=ts.call(e),i=t===S&&q.test(e)?e:$.data($(e)[0],"jqote_id");return $.jqotecache[i]||_},jqotetag:function(s){if(ts.call(s)===S){c=s}},jqotenc:function(s){return s.toString().replace(/&(?!\w+;)/g,"&#38;").split("<").join("&#60;").split(">").join("&#62;").split('"').join("&#34;").split("'").join("&#39;")},jqotecache:{}});$.event.special.jqote={add:function(o){var n,h=o.handler,d=!o.data?[]:ts.call(o.data)!==A?[o.data]:o.data;if(!o.namespace){o.namespace="app.pre.sub"}if(!d.length||!(n=dns(l(d)))){return}o.handler=function(e,m,r){return !r||r.test(n)?h.apply(this,[e,m]):null}}}})($);
/* Copyright (c) 2010 Brandon Aaron (http://brandonaaron.net)
	* Licensed under the MIT License (LICENSE.txt).
	*
	* Version 2.1.2
	*/
(function(a){a.fn.bgiframe=(a.browser.msie&&/msie 6\.0/i.test(navigator.userAgent)?function(d){d=a.extend({top:"auto",left:"auto",width:"auto",height:"auto",opacity:true,src:"javascript:false;"},d);var c='<iframe class="bgiframe"frameborder="0"tabindex="-1"src="'+d.src+'"style="display:block;position:absolute;z-index:-1;'+(d.opacity!==false?"filter:Alpha(Opacity='0');":"")+"top:"+(d.top=="auto"?"expression(((parseInt(this.parentNode.currentStyle.borderTopWidth)||0)*-1)+'px')":b(d.top))+";left:"+(d.left=="auto"?"expression(((parseInt(this.parentNode.currentStyle.borderLeftWidth)||0)*-1)+'px')":b(d.left))+";width:"+(d.width=="auto"?"expression(this.parentNode.offsetWidth+'px')":b(d.width))+";height:"+(d.height=="auto"?"expression(this.parentNode.offsetHeight+'px')":b(d.height))+';"/>';return this.each(function(){if(a(this).children("iframe.bgiframe").length===0){this.insertBefore(document.createElement(c),this.firstChild)}})}:function(){return this});a.fn.bgIframe=a.fn.bgiframe;function b(c){return c&&c.constructor===Number?c+"px":c}})($);$.fn.preloadImages=function(callback){checklist=this.toArray();this.each(function(){$("<img>").attr({src:this}).load(function(){checklist.remove($(this).attr("src"));if(checklist.length==0){callback()}})})};$.fn.offsetRelativeTo=function(el){var $el=$(el),o1=this.offset(),o2=$el.offset();o1.top-=o2.top-$el.scrollTop();o1.left-=o2.left-$el.scrollLeft();return o1};(function($){var escapeable=/["\\\x00-\x1f\x7f-\x9f]/g,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};$.toJSON=typeof JSON==="object"&&JSON.stringify?JSON.stringify:function(o){if(o===null){return"null"}var type=typeof o;if(type==="undefined"){return undefined}if(type==="number"||type==="boolean"){return""+o}if(type==="string"){return $.quoteString(o)}if(type==="object"){if(typeof o.toJSON==="function"){return $.toJSON(o.toJSON())}if(o.constructor===Date){var month=o.getUTCMonth()+1,day=o.getUTCDate(),year=o.getUTCFullYear(),hours=o.getUTCHours(),minutes=o.getUTCMinutes(),seconds=o.getUTCSeconds(),milli=o.getUTCMilliseconds();if(month<10){month="0"+month}if(day<10){day="0"+day}if(hours<10){hours="0"+hours}if(minutes<10){minutes="0"+minutes}if(seconds<10){seconds="0"+seconds}if(milli<100){milli="0"+milli}if(milli<10){milli="0"+milli}return'"'+year+"-"+month+"-"+day+"T"+hours+":"+minutes+":"+seconds+"."+milli+'Z"'}if(o.constructor===Array){var ret=[];for(var i=0;i<o.length;i++){ret.push($.toJSON(o[i])||"null")}return"["+ret.join(",")+"]"}var name,val,pairs=[];for(var k in o){type=typeof k;if(type==="number"){name='"'+k+'"'}else{if(type==="string"){name=$.quoteString(k)}else{continue}}type=typeof o[k];if(type==="function"||type==="undefined"){continue}val=$.toJSON(o[k]);pairs.push(name+":"+val)}return"{"+pairs.join(",")+"}"}};$.evalJSON=typeof JSON==="object"&&JSON.parse?JSON.parse:function(src){return eval("("+src+")")};$.secureEvalJSON=typeof JSON==="object"&&JSON.parse?JSON.parse:function(src){var filtered=src.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"");if(/^[\],:{}\s]*$/.test(filtered)){return eval("("+src+")")}else{throw new SyntaxError("Error parsing JSON, source is not valid.")}};$.quoteString=function(string){if(string.match(escapeable)){return'"'+string.replace(escapeable,function(a){var c=meta[a];if(typeof c==="string"){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"'}return'"'+string+'"'}})($);(function($){var _this;if(!("__jquery_xdomain__" in $)&&$.browser.msie&&"XDomainRequest" in window&&!("XMLHttpRequest" in window&&"withCredentials" in new XMLHttpRequest())&&document.location.href.indexOf("file:///")==-1){$.__jquery_xdomain__=$.support.cors=true;var urlMatcher=/^(((([^:\/#\?]+:)?(?:\/\/((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?]+)(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,oldxhr=$.ajaxSettings.xhr,sessionCookie="XDR_SESSION_COOKIE_NAME" in window?window.XDR_SESSION_COOKIE_NAME:"jsessionid",cookies="XDR_COOKIE_HEADERS" in window?window.XDR_COOKIE_HEADERS:[],headers="XDR_HEADERS" in window?window.XDR_HEADERS:["Content-Type"],ReadyState={UNSENT:0,OPENED:1,LOADING:3,DONE:4},debug=window.XDR_DEBUG&&"console" in window,XDomainRequestAdapter,domain,reqId=0;function forEachCookie(names,fn){if(typeof names=="string"){names=[names]}var i,cookie;for(i=0;i<names.length;i++){cookie=new RegExp("(?:^|; )"+names[i]+"=([^;]*)","i").exec(document.cookie);cookie=cookie&&cookie[1];if(cookie){fn.call(null,names[i],cookie)}}}function parseResponse(str){if(str.length>=5){var sub=str.substring(str.length<=20?0:str.length-20),i=sub.length-1,end,hl,st;if(sub.charAt(i)==="~"){for(end=i--;i>=0&&sub.charAt(i)!=="~";i--){}hl=parseInt(sub.substring(i+1,end));if(!isNaN(hl)&&hl>=0&&i>=2&&sub.charAt(i)==="~"){for(end=i--;i>=0&&sub.charAt(i)!=="~";i--){}st=parseInt(sub.substring(i+1,end));if(!isNaN(st)&&i>=0&&sub.charAt(i)==="~"){end=str.length-hl-sub.length+i;return[st,str.substring(0,end),str.substr(end,hl)]}}}}return[200,str,""]}function parseUrl(url){if(typeof(url)==="object"){return url}var matches=urlMatcher.exec(url);return matches?{href:matches[0]||"",hrefNoHash:matches[1]||"",hrefNoSearch:matches[2]||"",domain:matches[3]||"",protocol:matches[4]||"",authority:matches[5]||"",username:matches[7]||"",password:matches[8]||"",host:matches[9]||"",hostname:matches[10]||"",port:matches[11]||"",pathname:matches[12]||"",directory:matches[13]||"",filename:matches[14]||"",search:matches[15]||"",hash:matches[16]||""}:{}}function parseCookies(header){if(header.length==0){return[]}var cooks=[],i=0,start=0,end,dom;do{end=header.indexOf(",",start);cooks[i]=(cooks[i]||"")+header.substring(start,end==-1?header.length:end);start=end+1;if(cooks[i].indexOf("Expires=")==-1||cooks[i].indexOf(",")!=-1){i++}else{cooks[i]+=","}}while(end>0);for(i=0;i<cooks.length;i++){dom=cooks[i].indexOf("Domain=");if(dom!=-1){cooks[i]=cooks[i].substring(0,dom)+cooks[i].substring(cooks[i].indexOf(";",dom)+1)}}return cooks}domain=parseUrl(document.location.href).domain;XDomainRequestAdapter=function(){var self=this,_xdr=new XDomainRequest(),_mime,_reqHeaders=[],_method,_url,_id=reqId++,_setState=function(state){self.readyState=state;if(typeof self.onreadystatechange==="function"){self.onreadystatechange.call(self)}},_done=function(state,code){if(!self.responseText){self.responseText=""}if(debug){console.log("[XDR-"+_id+"] request end with state "+state+" and code "+code+" and data length "+self.responseText.length)}self.status=code;if(!self.responseType){_mime=_mime||_xdr.contentType;if(_mime.match(/\/json/)){self.responseType="json";self.response=self.responseText}else{if(_mime.match(/\/xml/)){self.responseType="document";var $error,dom=new ActiveXObject("Microsoft.XMLDOM");dom.async=false;dom.loadXML(self.responseText);self.responseXML=self.response=dom;if($(dom).children("error").length!=0){$error=$(dom).find("error");self.status=parseInt($error.attr("response_code"))}}else{self.responseType="text";self.response=self.responseText}}}_setState(state);_xdr=null;_reqHeaders=null;_url=null};_xdr.onprogress=function(){_setState(ReadyState.LOADING)};_xdr.ontimeout=function(){_done(ReadyState.DONE,408)};_xdr.onerror=function(){_done(ReadyState.DONE,500)};_xdr.onload=function(){var cooks,i,resp=parseResponse(_xdr.responseText||"");if(debug){console.log("[XDR-"+reqId+"] parsing cookies for header "+resp[2])}cooks=parseCookies(resp[2]);self.responseText=resp[1]||"";if(debug){console.log("[XDR-"+_id+"] raw data:\n"+_xdr.responseText+"\n parsed response: status="+resp[0]+", header="+resp[2]+", data=\n"+resp[1])}for(i=0;i<cooks.length;i++){if(debug){console.log("[XDR-"+_id+"] installing cookie "+cooks[i])}document.cookie=cooks[i]+";Domain="+document.domain}_done(ReadyState.DONE,resp[0]);if(typeof(_this.success)==="function"){_this.success(resp[1])}resp=null};this.readyState=ReadyState.UNSENT;this.status=0;this.statusText="";this.responseType="";this.timeout=0;this.withCredentials=false;this.overrideMimeType=function(mime){_mime=mime};this.abort=function(){_xdr.abort()};this.setRequestHeader=function(k,v){if($.inArray(k,headers)>=0){_reqHeaders.push({k:k,v:v})}};this.open=function(m,u){_url=u;_method=m;_setState(ReadyState.OPENED)};this.send=function(data){_xdr.timeout=this.timeout;if(sessionCookie||cookies||_reqHeaders.length){var h,addParam=function(name,value){var q=_url.indexOf("?");_url+=(q==-1?"?":"&")+name+"="+encodeURIComponent(value);if(debug){console.log("[XDR-"+_id+"] added parameter "+name+"="+value+" => "+_url)}};for(h=0;h<_reqHeaders.length;h++){addParam(_reqHeaders[h].k,_reqHeaders[h].v)}forEachCookie(sessionCookie,function(name,value){var q=_url.indexOf("?");if(q==-1){_url+=";"+name+"="+value}else{_url=_url.substring(0,q)+";"+name+"="+value+_url.substring(q)}if(debug){console.log("[XDR-"+_id+"] added cookie "+_url)}});forEachCookie(cookies,addParam);addParam("_xdr",""+_id)}if(debug){console.log("[XDR-"+_id+"] opening "+_url)}_xdr.open(_method,_url);if(debug){console.log("[XDR-"+_id+"] send, timeout="+_xdr.timeout)}_xdr.send(data)};this.getAllResponseHeaders=function(){return""};this.getResponseHeader=function(){return null}};$.ajaxSettings.xhr=function(){var target=parseUrl(this.url).domain;_this=this;if(target===""||target===domain){return oldxhr.call($.ajaxSettings)}else{try{return new XDomainRequestAdapter()}catch(e){}}}}})($);$.fn.equals=function(other){if(this.length!=other.length){return false}var result=true;this.each(function(i){if(this!=other[i]){result=false;return false}});return result};$.fn.equalsNative=function(x,y){var p;for(p in y){if(typeof(x[p])=="undefined"){return false}}for(p in y){if(y[p]){switch(typeof(y[p])){case"object":if(!y[p].equals(x[p])){return false}break;case"function":if(typeof(x[p])=="undefined"||(p!="equals"&&y[p].toString()!=x[p].toString())){return false}break;default:if(y[p]!=x[p]){return false}}}else{if(x[p]){return false}}}for(p in x){if(typeof(y[p])=="undefined"){return false}}return true}};(function(){$elc.classes.ControllerAPI=$elc.util.Class.extend({$log:new $elc.util.ClassLog("ctrl.api",true),$ela:null,$ela_old:null,$api:null,acceptableFuncArr:["_log","_addEventListener","_removeEventListener","_addTransOrder","addTransDetail","trackTrans"],init:function(){var a=this;a.$api=$elj({})},startup:function(){var a=this,b;if(window.$ela!==undefined){if($elj.isArray(window.$ela)){a.$ela_old=window.$ela}}a.$ela={};a.$ela.push=$elj.proxy(a.push,a);a.$ela.log=$elj.proxy(a.log,a);window.$ela=a.$ela;if($elj.isArray(a.$ela_old)){for(b=0;b<a.$ela_old.length;b+=1){a.push(a.$ela_old[b])}}a.trigger(new $elj.Event($elc.enums.EventType.API_ElicitLoad))},push:function(b){var a=this,c;if($elj.isArray(b)&&b.length>0){c=b.splice(0,1);if(!$elj.inArray(c)){throw {name:"elicit API Error",level:"Error",message:"Invalid function name.",htmlMessage:"Invalid function name."}}else{c=a[c];if(c!==undefined){c.apply(a,b)}}}},_log:function(b){try{window.console.log("[ELC.API] "+b)}catch(a){}},_addEventListener:function(c,b){var a=this;a.$api.bind(c,b)},_removeEventListener:function(c,b){var a=this;a.$api.unbind(c,b)},_addTransOrder:function(i,f,g,l,n,j,c,k,b){var a=this,h,d;h=new $elc.classes.ModelEcomOrder(i,f,g,l,n,j,c,k,b);d=new $elj.Event($elc.enums.EventType.TrackingAddTransOrder,h);d._data=h;$elj(a).trigger(d)},_addTransDetail:function(g,j,h,c,d,k,i){var a=this,f,b;f=new $elc.classes.ModelEcomDetail(g,j,h,c,d,k,i);b=new $elj.Event($elc.enums.EventType.TrackingAddTransDetail);b._data=f;$elj(a).trigger(b)},_trackTrans:function(){var a=this,b;b=new $elj.Event($elc.enums.EventType.TrackingTrackTrans);$elj(a).trigger(b)},trigger:function(b){var a=this;a.$api.trigger(b)}})})();(function(){var a={tracking:null,query:null,visit:null,ui:null,_clientInput:null,state:null,$log:new $elc.util.ClassLog("ctrl.app",true),templates:null,api:null,init:function(){},initialize:function(){this.api=new $elc.classes.ControllerAPI();this.state=new $elc.classes.ControllerAppState();this.tracking=new $elc.classes.ControllerTracking();this.tracking.handleLoadEvent();this.api.startup();this.$log.log("isLearningMode:"+$elc.config.get("isLearningMode"));if($elc.config.get("isLearningMode")){$elc.log(":: LEARNING MODE ::")}else{var b=$elc.config.get("appStartupDelay"),c=this;if(b===undefined){b=-1}if(b>-1){setTimeout(function(){c.startup()},b)}else{this.startup()}}},startup:function(){var b=this.startupCheck();if(!b){return}this.query=new $elc.classes.ControllerQuery();this.visit=new $elc.classes.ControllerVisit();this.templates=new $elc.classes.ViewTemplates(),this.ui=new $elc.classes.ControllerUI();this.ui.startup();this.bindEvents()},startupCheck:function(){this._clientInput=$elj($elc.config.get("clientSearchInputFieldSelector"));var b=this._clientInput.is(":focus");if(b&&$elc.util.isiTouch()){this._clientInput.bind("blur",$elj.proxy(this.startupCheckHandleBlur,this));return false}else{return true}},startupCheckHandleBlur:function(){this._clientInput.unbind("blur",$elj.proxy(this.handleInputBlur,this));this.startup()},bindEvents:function(){$elj(this.ui).bind($elc.enums.EventType.QuerySend,$elj.proxy(this.tracking.handleQuerySend,this.tracking)).bind($elc.enums.EventType.QueryCancel,$elj.proxy(this.query.cancel,this.query)).bind($elc.enums.EventType.VisitResult,$elj.proxy(this.tracking.handleVisitResult,this.tracking)).bind($elc.enums.EventType.VisitSearchAll,$elj.proxy(this.tracking.handleVisitSearchAll,this.tracking)).bind($elc.enums.EventType.SearchClose,$elj.proxy(this.tracking.handleTrackSearchClose,this.tracking));$elj(this.query).bind($elc.enums.EventType.QueryResponse,$elj.proxy(this.handleQueryResponse,this));$elj(this.tracking).bind($elc.enums.EventType.QuerySend,$elj.proxy(this.query.send,this.query)).bind($elc.enums.EventType.VisitResult,$elj.proxy(this.visit.handleVisitResult,this.visit)).bind($elc.enums.EventType.VisitSearchAll,$elj.proxy(this.visit.handleVisitSearchAll,this.visit));$elj(this.visit).bind($elc.enums.EventType.VisitSearchAll,$elj.proxy(this.ui.triggerSubmit,this.ui))},handleQueryResponse:function(b){this.ui.handleQueryResponse(b);this.tracking.handleQueryResponse(b)}};$elc.classes.ControllerApp=$elc.util.Class.extend(a)})();(function(){var a={$log:new $elc.util.ClassLog("ctrl.app.state",true),defaults:{isUnloadInProgress:false,isVisitInProgress:false,isResultsViewOpen:false,isResultSelected:false},_attributes:{},init:function(b){if(b===undefined){b={}}this._attributes=$elj.extend({},this.defaults,b);this.bindEvents();this.handleWindowResize()},get:function(b){return this._attributes[b]},set:function(b,c){this._attributes[b]=c},bindEvents:function(){var b=this;$elj(window).bind("resize",$elj.proxy(b.handleWindowResize,b))},handleWindowResize:function(){var d=$elj(window).width(),c,b=false;if($elc.config.get("isResponsive")){if(d<=$elc.config.get("responsiveMobileAtWidth")&&$elc.config.get("platform")==$elc.enums.PlatformType.Site){$elc.config.set("platform",$elc.enums.PlatformType.Mobile);b=true}else{if(d>$elc.config.get("responsiveMobileAtWidth")&&$elc.config.get("platform")==$elc.enums.PlatformType.Mobile){$elc.config.set("platform",$elc.enums.PlatformType.Site);b=true}}if(b){c=new $elj.Event($elc.enums.EventType.ResponsiveChange,{platform:$elc.config.get("platform")});this.handleSelfTrigger(c);$elc.app.api.trigger($elj.Event($elc.enums.EventType.API_ResponsiveChange,{platform:$elc.config.get("platform")}))}}},bind:function(c,b){$elj(this).bind(c,b)},unbind:function(c,b){$elj(this).unbind(c,b)},handleSelfTrigger:function(b){$elj(this).trigger(b)},isMobile:function(){var b=$elc.config.get("isMobile");if($elc.config.get("isResponsive")){if($elc.config.get("platform")==$elc.enums.PlatformType.Mobile){b=true}}return b}};$elc.classes.ControllerAppState=$elc.util.Class.extend(a)})();(function(){var a={view:null,searchHint:null,$searchHint:null,$inputbox:null,$clientInputBox:null,$submitBtn:null,lastQuery:"",$form:null,allowSubmit:false,blurDelay_id:-1,blurDelay:200,isClientInputAndElicitInputDiff:false,hintConfig:{},poll_id:-1,pollInterval_ms:2000,curResponse:null,$hintDiv:null,$log:new $elc.util.ClassLog("ctrl.input",true),hasUserQueriedDuringSearchSession:false,keystrokesForSearchSession:0,refinementsForSearchSession:0,backspacingInProcess:false,queriesSentThisSearchSession:{},lastResponse:null,isQueryInProgress:false,init:function(){var b=this,c;b.$clientInputBox=$elj($elc.config.get("clientSearchInputFieldSelector"));if($elc.config.get("clientSearchInputFieldSelector")!=$elc.config.get("elcSearchInputFieldSelector")&&$elj($elc.config.get("clientSearchInputFieldSelector")).length>0){b.isClientInputAndElicitInputDiff=true}c=b.$clientInputBox.val();if(c==$elc.config.get("defaultSearchInputText")){c=""}b.view=new $elc.classes.ViewInput();b.view.startup();b.$form=$elj($elc.config.get("searchFormSelector"));b.$inputbox=$elj($elc.config.get("elcSearchInputFieldSelector"));b.$submitBtn=$elj($elc.config.get("elcSearchInputButtonSelector"));b.setupPlugin();b.setupEvents();if($elc.util.isIE6()){$elc.util.redrawElement(b.$form)}if($elc.config.get("isClientInputBoxFocusedOnStart")){b.$inputbox.focus();if($elc.util.bodyTagHas("elc-ie")){setTimeout(function(){b.$inputbox.focus()},0)}}if(c===""){c=b.$inputbox.val()}if(!$elc.util.stringIsNullOrEmpty(c)){setTimeout(function(){b.searchHint.setKey(c)},1)}},setupPluginConfig:function(){var b=this;b.hintConfig={resultNum:0,enter:$elj.proxy(b.handleInputEnterKey,b),enterClearsHint:false,spinnerConfig:$elc.config.get("spinnerConfig"),useHintPlaceholderInput:$elc.config.get("useInputPlaceholder")}},setupPlugin:function(){var b=this;b.setupPluginConfig();b.searchHint=b.$inputbox.elcHint(b.hintConfig);b.$searchHint=b.$form.find(".elc-hint-container");b.$hintDiv=b.$form.find(".elc-hint-match");this.$inputbox=$elj($elc.config.get("elcSearchInputFieldSelector"))},setupEvents:function(c){var b=this;if(c===undefined){c=true}b.$inputbox.unbind(b.searchHint.HINT_EVENT,$elj.proxy(b.handleInputHint,b)).unbind(b.searchHint.CLEAR_EVENT,$elj.proxy(b.handleInputCleared,b)).unbind(b.searchHint.KEY_NAV_EVENT,$elj.proxy(b.handleKeyNav,b)).unbind(b.searchHint.ESCAPE_EVENT,$elj.proxy(b.handleEscape,b)).unbind(b.searchHint.CANCEL_EVENT,$elj.proxy(b.handleSearchHintCancel,b)).unbind("focus",$elj.proxy(b.handleInputFocus,b)).unbind("blur",$elj.proxy(b.handleBlur,b));b.$form.unbind("submit",$elj.proxy(b.handleSubmit,b));b.$submitBtn.unbind("click",$elj.proxy(b.handleSubmitBtnClick,b));$elc.app.state.unbind($elc.enums.EventType.ResponsiveChange,$elj.proxy(b.handleResponsiveChanged,b));$elj(window).unbind("pageshow",$elj.proxy(b.handlePageShow,b));if(c){b.$inputbox.bind(b.searchHint.HINT_EVENT,$elj.proxy(b.handleInputHint,b)).bind(b.searchHint.CLEAR_EVENT,$elj.proxy(b.handleInputCleared,b)).bind(b.searchHint.KEY_NAV_EVENT,$elj.proxy(b.handleKeyNav,b)).bind(b.searchHint.ESCAPE_EVENT,$elj.proxy(b.handleEscape,b)).bind(b.searchHint.CANCEL_EVENT,$elj.proxy(b.handleSearchHintCancel,b)).bind("focus",$elj.proxy(b.handleInputFocus,b)).bind("blur",$elj.proxy(b.handleBlur,b));b.$form.bind("submit",$elj.proxy(b.handleSubmit,b));b.$submitBtn.bind("click",$elj.proxy(b.handleSubmitBtnClick,b));$elc.app.state.bind($elc.enums.EventType.ResponsiveChange,$elj.proxy(b.handleResponsiveChanged,b));$elj(window).bind("pageshow",$elj.proxy(b.handlePageShow,b))}},handleInputFocus:function(){var b=this,c;b.$log.log("elicit.controller.input : handleInputFocus ");clearTimeout(b.blurDelay_id);b.setupPollingFailsafe();c=new $elc.classes.EventInput($elc.enums.EventType.InputFocus);b.triggerSelf(c)},handleSubmit:function(c){var b=this.handleSubmitCheck(c);if(this.isClientInputAndElicitInputDiff){this.$clientInputBox.val(this.$inputbox.val())}this.$log.log("handleSubmit allow:"+b);return b},handleSubmitCheck:function(d){var b=this,c=true,g;g=$elj.trim(b.$inputbox.val()).length===0;b.$log.log("input controller handleSubmit canFormSubmit:"+$elc.config.get("canFormSubmit")+" isEmpty:"+g);if(g||!$elc.config.get("canFormSubmit")){b.$log.log("stop the submit");c=false;try{d.preventDefault();d.stopPropagation();d.stopImmediatePropagation()}catch(f){}}return c},handleInputHint:function(d){var b=this,j=b.$inputbox.val(),g,f,i,h,c;b.$log.log("handleInputHint val:"+j+" lastQuery:"+b.lastQuery);if(j==b.lastQuery){b.searchHint.showSpinner(false)}else{b.detectRefinement(j,b.lastQuery);b.keystrokesForSearchSession+=1;if(j===""){c=new $elj.Event(b.searchHint.CLEAR_EVENT);c.inputHadValue=b.lastQuery!=="";b.handleInputCleared(c);b.triggerCloseEvent()}else{g=false;f=b.getHintCur();if(b.curResponse!==null&&b.lastQuery!==""&&b.lastQuery.length<j.length&&b.curResponse.d.dm===1&&b.curResponse.d.rr===0&&f.toLowerCase().indexOf(j.toLowerCase())===0){g=true}b.$log.log("querysend? isQuerySameAsHint:"+g+" curResponse:"+this.curResponse);if(b.curResponse===null||true){i=new $elc.classes.EventQuery($elc.enums.EventType.QuerySend,j,null,d?d.bolInputFilledWithHint:false,b.keystrokesForSearchSession,b.refinementsForSearchSession,g);b.$log.log("send query "+i);b.triggerSelf(i);b.isQueryInProgress=true}else{b.searchHint.showSpinner(false);if(!$elc.config.get("isMobile")&&d!==undefined&&d.bolInputFilledWithHint){h=new $elj.Event();h.key=this.searchHint.KEY_NAV_DOWN;h.isInputFillWithHint=true;b.handleKeyNav(h)}}}if(b.isClientInputAndElicitInputDiff&&b.$clientInputBox.length>0){b.$clientInputBox.val(j)}}b.hasUserQueriedDuringSearchSession=true;b.lastQuery=j},triggerCloseEvent:function(d){var b=this,c;b.$log.log("trigger close event "+d);if(d){b.triggerSearchClose()}c=new $elc.classes.EventInput($elc.enums.EventType.ViewResultClose);b.triggerSelf(c)},triggerSearchClose:function(){var b=this,g="",f="",d,h;if($elc.app.state.get("isVisitInProgress")||$elc.app.state.get("isUnloadInProgress")){return}b.$log.log("trigger search close $elc.app.state.get(isVisitInProgress)"+$elc.app.state.get("isVisitInProgress")+" $elc.app.state.get(isUnloadInProgress)"+$elc.app.state.get("isUnloadInProgress"));if(b.lastResponse!==undefined&&b.lastResponse!==null){b.lastInput=b.lastResponse.d.i;b.lastKeyword=b.lastResponse.d.h}try{d={input:f,keyword:g,queryNum:b.keystrokesForSearchSession,refinementNum:b.refinementsForSearchSession,analyticsEventType:$elc.enums.AnalyticsEventType.SearchClose,resultsFound:this.lastResponse!==null?b.lastResponse.d.catArr.length>0:0};h=$elj.Event($elc.enums.EventType.SearchClose,d);b.triggerSelf(h)}catch(c){}b.hasUserQueriedDuringSearchSession=false;b.keystrokesForSearchSession=0;b.refinementsForSearchSession=0;b.queriesSentThisSearchSession={};b.backspacingInProcess=false;b.lastResponse=null},handleInputEnterKey:function(f){var b=this,c=this.handleSubmitCheck(f),d,g,h,i=false,j=false;if(c){if(b.curResponse!==null&&b.curResponse.d.i==b.$inputbox.val()){i=true}if(b.curResponse!==null&&b.curResponse.d.cs!==undefined){j=true}if((i&&!j)||($elc.config.get("allowEnterKeyToSubmitFullSearch")&&!$elc.app.state.get("isResultSelected"))){b.triggerSubmit();return false}}d=$elj.Event($elc.enums.EventType.InputNav);if(b.searchHint){g=b.searchHint.getHint();h=b.$inputbox.val();if(g!==undefined&&g!==null){g=g.toLowerCase()}h=h.toLowerCase()}d.bolHintWillFillInput=g!==""&&g!=h;b.$log.log("bolHintWillFillInput:"+d.bolHintWillFillInput+" h_input:"+h+" h_hint:"+g);d.key=$elc.enums.KeyType.Enter;b.triggerSelf(d);return false},handleInputCleared:function(){var b=this,c=new $elc.classes.EventQuery($elc.enums.EventType.QueryCancel);b.$log.log("handleInputCleared");$elj(b).trigger(c);b.lastQuery="";b.isQueryInProgress=false},handleEscape:function(f,g,c,i){var b=this,d=b.searchHint.getHint(),h;b.$log.log("handleEscape hasResults:"+g+" areResultsOpen:"+c+" triggerAPI event:"+i);if(c===undefined&&b.$inputbox.val().length>0){if(d===""||d==b.$inputbox.val()){b.lastQuery="";b.searchHint.reset(true)}else{b.searchHint.setHint("")}}else{if(c===false||c===undefined){b.lastQuery="";b.searchHint.reset(true)}else{if(c&&b.$inputbox.val().length>0){b.searchHint.setHint("")}}}h=new $elc.classes.EventQuery($elc.enums.EventType.QueryCancel);b.triggerSelf(h);b.triggerCloseEvent(i);b.handleQueryCancel();b.$log.log("handleescape lastQuery:"+b.lastQuery)},handleSearchHintCancel:function(){var b=this,c=new $elc.classes.EventQuery($elc.enums.EventType.QueryCancel);$elj(b).trigger(c);b.handleQueryCancel()},handleKeyNav:function(c){var b=this,d=$elj.Event($elc.enums.EventType.InputNav);b.$log.log("handleKeyNav:"+c.key);switch(c.key){case b.searchHint.KEY_NAV_UP:d.key=$elc.enums.KeyType.Up;break;case b.searchHint.KEY_NAV_DOWN:d.key=$elc.enums.KeyType.Down;break}b.triggerSelf(d)},handleSubmitBtnClick:function(d){var b=this,c=this.handleSubmitCheck(d),f;b.$log.log("handleSubmitBtnClick:"+d+" allowsubmit:"+c);if(c){$elc.app.state.set("isVisitInProgress",true);setTimeout(function(){f=$elj.Event($elc.enums.EventType.InputNav);f.key=$elc.enums.KeyType.Submit;f.input=b.$inputbox.val();b.triggerSelf(f)},0)}return false},handleQueryResponse:function(c){var b=this,f=false,d;b.isQueryInProgress=false;if(b.$inputbox.val().indexOf(c.d.i)!==0){b.$log.log("input rejecting response input:'"+b.$inputbox.val()+"' i:'"+c.d.i+"'");f=false}else{b.curResponse=c;b.lastResponse=c;d=b.getHintCur();b.$log.log("handleQueryResponse input SET HINT : '"+d+"' inputbox: '"+b.$inputbox.val()+"'");b.searchHint.setHint(d);f=true}return f},handleQueryCancel:function(){var b=this;b.curResponse=null;b.searchHint.showSpinner(false);b.isQueryInProgress=false},triggerSubmit:function(){var b=this;b.$log.log("input triggerSubmit");b.allowSubmit=true;b.$form.submit()},triggerSelf:function(c){var b=this;$elj(b).trigger(c)},handleInputSet:function(c){var b=this;b.searchHint.setKey(c.val)},handleVisible:function(){var b=this;b.searchHint.refreshViewWidths()},setupPollingFailsafe:function(){return},handlePollInterval:function(){this.handleInputCheckForChange()},handleInputCheckForChange:function(){var b=this.$inputbox.val();if(b!=this.lastQuery){this.$log.log("handleInputCheckForChange! val:"+b+" lastQuery:"+this.lastQuery);this.handleInputHint()}},getHintCur:function(){var d="",f,c,b=this.curResponse;if(this.curResponse!==null){d="";f=b.d.hs===undefined||b.d.hs===null?"":b.d.hs;c=b.d.he===undefined||b.d.he===null?"":b.d.he;d=f+c.toLowerCase()}return d},handleBlur:function(){var b=this;b.$log.log("handleBlur");b.setupPollingFailsafe(false);clearTimeout(b.blurDelay_id);b.blurDelay_id=setTimeout(function(){b.handleBlurDelayed()},b.blurDelay);b.triggerSelf(new $elc.classes.EventInput($elc.enums.EventType.InputBlur))},handleBlurDelayed:function(){var b=true;if($elc.app.state.isMobile()&&this.$inputbox.val()!==""){b=false}if(this.isQueryInProgress){b=false}if(!this.hasUserQueriedDuringSearchSession){b=false}if($elc.app.state.get("isResultsViewOpen")){b=false}if(b){this.$log.log("trigger search close from blur delay");this.triggerSearchClose()}return},fillInputWithHint:function(){this.searchHint.fillInputWithHint()},handleResponsiveChanged:function(b){this.$log.log("handleResponsiveChanged e.platform:"+b.platform);this.searchHint.refreshViewWidths()},detectRefinement:function(b,d){var c=false;if(b.length<d.length){if(d.indexOf(b)===0){if(!this.backspacingInProcess){this.backspacingInProcess=true;c=true}}else{c=true}}else{if(b.indexOf(d)===0){if(this.backspacingInProcess){this.backspacingInProcess=false;c=true}}}if(c&&(this.backspacingInProcess||(this.queriesSentThisSearchSession[b]===undefined&&b!==""))){this.refinementsForSearchSession+=1}this.queriesSentThisSearchSession[b]=1},handlePageShow:function(){if($elc.util.isiTouch()){this.searchHint.reset()}}};$elc.classes.ControllerInput=$elc.util.Class.extend(a)})();(function(){var a={resultData:null,catArr:[],matchCur:null,activeRequest:null,request_id:0,request_id_parsed:0,cachedResults:{},curResponse:null,queryServicePath:$elc.config.get("protocol")+$elc.config.get("serviceQuery"),curRequestInEvent:null,$log:new $elc.util.ClassLog("ctrl.query",true),init:function(){this.bindEvents()},bindEvents:function(){var b=$elj(this);b.unbind($elc.enums.EventType.Query);b.bind($elc.enums.EventType.QuerySend,$elj.proxy(this.send,this));b.bind($elc.enums.EventType.QueryCancel,$elj.proxy(this.cancel,this))},send:function(f){this.cancel();this.curRequestInEvent=f;$elc.app.api.trigger($elj.Event($elc.enums.EventType.API_QueryKeystroke,{term:f.i}));var b=this.cacheGet(f.i),g,c;if(b){this.$log.log("query '"+f.i+"' IS CACHED");this.handleResponse(b,"success",{},true);return}g=this.setNextRequestId();c={q:f.i,r:this.request_id,sn:$elc.config.get("site"),su:$elc.config.get("username"),l:$elc.config.get("locale"),p:$elc.config.get("platform"),f:window.location.toString()};this.$log.log('sendQuery: "'+c.q+'" requestnum: '+c.r);this.activeRequest=$elj.ajax({url:this.queryServicePath,data:c,context:document.body,dataType:"jsonp",success:$elj.proxy(this.handleResponse,this),error:$elj.proxy(this.handleError,this),cache:false})},handleError:function(c,d,b){this.$log.log("!!! query response error");this.handleResponse()},handleResponse:function(e,i,h,g){var c=new $elc.classes.ModelResult(e),b,f="";this.$log.log("handleResponse data requestnum: "+c.r+"  getRequestId:"+this.getRequestId()+" getLastRequestIdParsed():"+this.getLastRequestIdParsed()+" request_id_parsed:"+this.request_id_parsed);if(g===undefined){g=false}if(c.r<this.getRequestId()||this.curRequestInEvent===null){if(!g){this.cacheAdd(c.i,c);this.$log.log(" exiting old query response after cache add: '"+c.i+"'");return}}this.resultData=c;this.setLastRequestIdParsed(c.r);if(e!==undefined&&e!==null){if(e.cx!==undefined&&$elc.config.get("context")!==e.cx){$elc.config.set("context",e.cx)}if(e.lc!==undefined&&$elc.config.get("locale")!==e.lc){$elc.config.set("locale",e.lc);$elc.config.set("imgBasePath",$elc.config.replaceVariableValue($elc.config.get("imgBasePath_raw")))}if(e.i!==undefined){f=e.i}if(e.cs!==undefined){$elj(e.cs).each(function(d,j){b=new $elc.classes.ModelCategory(j);c.catArr.push(b)})}}this.curResponse=new $elc.classes.EventQuery($elc.enums.EventType.QueryResponse,c.i,c,this.curRequestInEvent?this.curRequestInEvent.onResponseSelectFirstResult:false);$elj(this).trigger(this.curResponse);if(!g){this.cacheAdd(c.i,c)}this.activeRequest=null;this.curRequestInEvent=null;if(c.catArr===null||c.catArr===undefined||c.catArr.length===0){$elc.app.api.trigger($elj.Event($elc.enums.EventType.API_ResultNone,{term:f}))}else{$elc.app.api.trigger($elj.Event($elc.enums.EventType.API_ResultHasResults,{term:e.i,num:c.catArr.length}))}},cancel:function(){this.curRequestInEvent=null},cacheAdd:function(c,b){var d=this.cachedResults[c];if(d===undefined){this.cachedResults[c]=b}},cacheGet:function(b){return this.cachedResults[b]},getResultData:function(){return this.resultData},overrideResultDataHint:function(b){this.resultData.termHint=b;this.resultData.termHintProper=b},setNextRequestId:function(){this.request_id+=1;return this.request_id},getRequestId:function(){return this.request_id},setLastRequestIdParsed:function(b){this.request_id_parsed=b},getLastRequestIdParsed:function(){return this.request_id_parsed}};$elc.classes.ControllerQuery=$elc.util.Class.extend(a)})();(function(){var self={request_id:0,activeRequest:null,recordSent:false,onloadSent:false,visitEvent:null,timeoutId:-1,timeoutMS:1000,onCompleteTimeoutMS:200,trackingService_url:$elc.config.get("protocol")+$elc.config.get("serviceTracking"),timeQueryFirst:-1,timeQueryLast:-1,$log:new $elc.util.ClassLog("ctrl.track",true),bolSearchAllHasBeenTracked:false,lastVisitTimestamp:0,lastVisitEvent:null,lastQueryEvent:null,trackingPlatforms:null,trackingEcom:null,init:function(){if($elc.classes.ControllerTrackingPlatforms!==undefined){this.trackingPlatforms=new $elc.classes.ControllerTrackingPlatforms()}if($elc.classes.ControllerTrackingEcom!==undefined){this.trackingEcom=new $elc.classes.ControllerTrackingEcom()}},handleLoadEvent:function(){if(this.onloadSent||!$elc.config.get("isTrackingEnabled")){return}this.onloadSent=true;var requestURL=this.trackingService_url,data={t:2,f:window.location.toString(),r:document.referrer,s:$elc.config.get("site"),l:$elc.config.get("locale"),c:$elc.config.get("context"),p:$elc.config.get("platform")};data.f=escape(data.f);data.r=escape(data.r);this.$log.log("sendOnLoadEvent "+data.f);this.activeRequest=$elj.ajax({url:requestURL,data:data,context:document.body,dataType:"jsonp",success:$elj.proxy(this.handleTrackLoadResult,this),cache:false});if(this.trackingEcom!==null){this.trackingEcom.startup()}},handleTrackLoadResult:function(data){this.$log.log("handleTrackLoadResult: "+(data!==undefined&&data!==null?data.r:"error"));this.activeRequest=null},handleVisitResult:function(e){$elc.app.api.trigger($elj.Event($elc.enums.EventType.API_ResultClick,{term:e.keyword,category:e.category,title:e.title,titleSub:e.titleSub,url:e.url,input:e.input}));this.handleVisitRecord(e)},handleVisitSearchAll:function(e){$elc.app.api.trigger($elj.Event($elc.enums.EventType.API_ResultSiteSearch,{term:e.keyword,input:e.input}));var $form,$input,$termTag,$catTag;if($elc.config.get("isSiteSearchVisitUrlAppendEnabled")){$form=$elj($elc.config.get("searchFormSelector"));$input=$elj($elc.config.get("elcSearchInputFieldSelector"));if($form.find("#"+$elc.config.get("siteSearchVisitTermTag")).length===0){$form.append("<input type='hidden' name='"+$elc.config.get("siteSearchVisitTermTag")+"' id='"+$elc.config.get("siteSearchVisitTermTag")+"' />");$form.append("<input type='hidden' name='"+$elc.config.get("siteSearchVisitCategoryTag")+"' id='"+$elc.config.get("siteSearchVisitCategoryTag")+"' />")}$termTag=$form.find("#"+$elc.config.get("siteSearchVisitTermTag"));$catTag=$form.find("#"+$elc.config.get("siteSearchVisitCategoryTag"));$termTag.val($input.val());$catTag.val($elc.config.get("siteSearchVisitCategoryTag_NoResultsValue"))}this.handleVisitRecord(e,this.bolSearchAllHasBeenTracked);this.bolSearchAllHasBeenTracked=e.shiftToMoreResults},handleVisitRecord:function(e,bolBypass){var isSame,d,t0,t1,t2,keystrokeNum,refinementNum,analyticsEventType,requestURL,now=(new Date()).getTime(),my=this;this.$log.log("handleVisitRecord bolBypass:"+bolBypass);this.visitEvent=e;if(bolBypass===undefined){bolBypass=false}if(e!==null&&this.lastVisitEvent!==null&&e.compare!==undefined){isSame=e.compare(this.lastVisitEvent);if(isSame){this.$log.log("bypassing visit - same as last event");bolBypass=true}}if(!$elc.config.get("isTrackingEnabled")||bolBypass){this.$log.log("bypassing visit");$elj(this).trigger(e);return}this.cancel();clearTimeout(this.timeoutId);d=new Date();t0=d.getTime();t1=-1;t2=-1;if(this.timeQueryFirst>-1){t1=Math.round((t0-this.timeQueryFirst)/1000);if(this.timeQueryLast>-1){t2=Math.round((t0-this.timeQueryLast)/1000)}}keystrokeNum=-1;refinementNum=-1;analyticsEventType=-1;if(this.lastQueryEvent!==null){keystrokeNum=this.lastQueryEvent.queryNum;refinementNum=this.lastQueryEvent.refinementNum}if(e!==undefined){if(e.analyticsEventType!==undefined){analyticsEventType=e.analyticsEventType}else{switch(e.fullEventType){case $elc.enums.EventType.VisitResult:analyticsEventType=$elc.enums.AnalyticsEventType.ResultClick;break;case $elc.enums.EventType.VisitSearchAll:analyticsEventType=$elc.enums.AnalyticsEventType.MoreResultsClick;break}}}this.request_id+=1;requestURL=this.trackingService_url;d={};d.t=1;d.ur=e.url;d.s=$elc.config.get("site");d.un=$elc.config.get("username");d.cx=$elc.config.get("context");d.l=$elc.config.get("locale");d.k=e.keyword;d.i=e.input;d.f=window.location.toString();d.rf=e.resultsFound?1:0;d.sm=e.shiftToMoreResults?1:0;d.ss=e.shiftToSiteSearch?1:0;d.ct=e.category;d.rr=document.referrer;d.t1=t1;d.t2=t2;d.p=$elc.config.get("platform");d.ae=analyticsEventType;d.ks=keystrokeNum;d.rn=refinementNum;d.ur=escape(d.ur);d.f=escape(d.f);d.rr=escape(d.rr);this.$log.log("ControllerTracking handleVisitRequest:"+e.keyword+" url:"+e.url+" t1:"+t1+" t2:"+t2+" shiftToSiteSearch:"+e.shiftToSiteSearch+" analyticsEventType:"+analyticsEventType+" url"+requestURL);this.activeRequest=$elj.ajax({url:requestURL,data:d,context:document.body,dataType:"jsonp",success:$elj.proxy(this.handleTrackVisitResult,this),cache:false});this.recordSent=true;this.lastVisitTimestamp=now;this.lastVisitEvent=e;this.timeoutId=setTimeout(function(){my.handleTrackVisitResult()},this.timeoutMS)},handleTrackVisitResult:function(data){this.$log.log("handleTrackResult: "+(data!==undefined&&data!==null?data.r:"timedout"));clearTimeout(this.timeoutId);this.timeoutId=-1;this.activeRequest=null;this.handleExternalTracking()},handleQuerySend:function(e){this.$log.log("handleTracking Query Send");this.lastQueryEvent=e;var d=new Date();if(this.timeQueryFirst==-1){this.timeQueryFirst=d.getTime()}this.$log.log("timeQueryFirst:"+this.timeQueryFirst);if(e){$elj(this).trigger(e)}},handleQueryResponse:function(){var d=new Date();this.timeQueryLast=d.getTime();this.$log.log("timeQueryFirst:"+this.timeQueryFirst+" timeQueryLast:"+this.timeQueryLast)},handleTrackResultClose:function(){this.$log.log("handleTrackResultClose")},handleTrackSearchClose:function(e){this.$log.log("handleTrackSearchClose");this.handleVisitRecord(e);this.handleQueryTimeReset(e)},handleTrackSearchCloseResult:function(data){this.$log.log("handleTrackSearchCloseResult: "+(data!==undefined&&data!==null?data.r:"error"));this.activeRequest=null},handleExternalTracking:function(){var siteTag,hasExternalTracking=false,i=0,trackingOb=null,trackingTag="",my=this;this.$log.log("handleExternalTracking");if(!$elc.config.get("trackingMap")||this.visitEvent===undefined||this.visitEvent===null){this.$log.log("goto complete");this.complete()}else{siteTag="site_"+$elc.config.get("site").toLowerCase();for(i=0;i<$elc.config.get("trackingMap").length;i+=1){trackingOb=$elc.config.get("trackingMap")[i];if(trackingOb.id.toLowerCase()==siteTag){hasExternalTracking=true;trackingTag+=trackingOb.value;break}}for(i=0;i<$elc.config.get("trackingMap").length;i+=1){trackingOb=$elc.config.get("trackingMap")[i];if(trackingOb.id==this.visitEvent.category){hasExternalTracking=true;trackingTag+=trackingOb.value;break}}this.$log.log("hasExternalTracking:"+hasExternalTracking);if(hasExternalTracking){trackingTag=trackingTag.replace("[[CATEGORY]]",this.visitEvent.category);trackingTag=trackingTag.replace("[[TITLE]]",this.visitEvent.title);this.$log.log("tackingTag"+trackingTag+" cat:"+this.visitEvent.category+" title:"+this.visitEvent.title);try{eval(trackingTag)}catch(e){this.$log.log("trackingTag eval failed "+e)}this.timeoutId=setTimeout(function(){my.handleExternalTrackingResult()},this.timeoutMS)}else{this.complete()}}},handleExternalTrackingResult:function(){clearTimeout(this.timeoutId);this.timeoutId=-1;this.complete()},complete:function(){var my=this;this.timeoutId=setTimeout(function(){my.triggerExit()},this.onCompleteTimeoutMS)},triggerExit:function(){this.$log.log("tracking complete:");if(this.visitEvent){$elj(this).trigger(this.visitEvent)}this.visitEvent=null},handleQueryTimeReset:function(){this.timeQueryFirst=-1;this.timeQueryLast=-1},cancel:function(){}};$elc.classes.ControllerTracking=$elc.util.Class.extend(self)})();(function(){var a={init:function(){if($elc.config.get("isTrackingEnabledFor_GA")){this.initGA()}},initGA:function(){try{_gaq.push(["_trackEvent","elicit-load",window.location.toString(),document.referrer])}catch(b){}$elc.app.api.push(["_addEventListener",$elc.enums.EventType.API_ResultClick,function(c){try{_gaq.push(["_trackEvent","elicit-category: "+c.category,c.term,c.url])}catch(d){}}]);$elc.app.api.push(["_addEventListener",$elc.enums.EventType.API_ResultSiteSearch,function(c){try{_gaq.push(["_trackEvent","elicit-category: Site Search",c.term])}catch(d){}}])}};$elc.classes.ControllerTrackingPlatforms=$elc.util.Class.extend(a)})();(function(){$elc.classes.ControllerTrackingEcom=$elc.util.Class.extend({wasMetaChecked:false,activeRequest:null,$log:new $elc.util.ClassLog("ctrl.track.ecom",true),ecomOrder:{},ecomDetailArr:[],init:function(){var a=this;a.bindEventsAPI()},startup:function(){if(this.wasMetaChecked||$elc.config.get("isTrackingEnabledFor_Ecom")===undefined||!$elc.config.get("isTrackingEnabledFor_Ecom")){return}this.wasMetaChecked=true;this.trackGoalPages()},trackGoalPages:function(){var a=$elc.config.get("trackingGoalECPages"),d=false,b="",c;if(a&&a.length>0){for(c=0;c<a.length;c+=1){b=a[c];if(b.toUpperCase()==document.URL.toUpperCase()){d=true;break}}if(d){this.$log.log("goal page found "+b);this.populateEcomMeta();this.sendEcomMeta()}}},populateEcomMeta:function(){try{switch($elc.config.get("trackingMetaECType")){case $elc.enums.EcomMetaType.WebTrends:this.populateEcomMeta_WT();break;case $elc.enums.EcomMetaType.GoogleAnalytics:this.populateEcomMeta_GA();break}}catch(a){}},populateEcomMeta_WT:function(){var f=this.getMeta("WT.tx_u").split(";").length,h,c,e=0,d=0,j=0,b,k,a,g;h=this.getMeta("WT.z_order_total")?this.getMeta("WT.z_order_total").split(";")[0]:"";this.ecomOrder=new $elc.classes.ModelEcomOrder(this.getMeta("WT.tx_i"),this.getMeta("WT.cg_s"),"",h,"","","","");this.ecomDetailArr=[];for(b=0;b<f;b+=1){j=this.getMeta("WT.tx_u")?parseInt(this.getMeta("WT.tx_u").split(";")[b],10):0;e=this.getMeta("WT.tx_s")?parseFloat(this.getMeta("WT.tx_s").split(";")[b],10):0;d=$elc.util.mathRoundNumber(e/j,2);k=this.getMeta("DCSext.pn_sku_combination")?this.getMeta("DCSext.pn_sku_combination").split(";")[b]:"";g=this.getMeta("DCSext.pn_id_combination")?this.getMeta("DCSext.pn_id_combination").split(";")[b]:"";a=this.getMeta("WT.pn_sc")?this.getMeta("WT.pn_sc").split(";")[b]:"";c=new $elc.classes.ModelEcomDetail(this.getMeta("WT.tx_i"),k,g,a,"",d,j);this.ecomDetailArr.push(c)}},populateEcomMeta_GA:function(){},bindEventsAPI:function(){var a=this;$elj($elc.app.api).bind($elc.enums.EventType.TrackingAddTransOrder,$elj.proxy(a.handleAddTransOrder,a));$elj($elc.app.api).bind($elc.enums.EventType.TrackingAddTransDetail,$elj.proxy(a.handleAddTransDetail,a));$elj($elc.app.api).bind($elc.enums.EventType.TrackingTrackTrans,$elj.proxy(a.handleTrackTrans,a))},handleAddTransOrder:function(b){var a=this;a.ecomOrder=b._data},handleAddTransDetail:function(b){var a=this;a.ecomDetailArr.push(b._data)},handleTrackTrans:function(){var a=this;a.sendEcomMeta()},sendEcomMeta:function(){var c=$elc.config.get("protocol"),a,b=this;if(!$elc.util.isIE()){c="https://"}c+=$elc.config.get("serviceTrackingEcom");a={d:{f:document.URL,r:document.referrer,s:$elc.config.get("site"),l:$elc.config.get("locale"),cx:$elc.config.get("context"),p:$elc.config.get("platform"),tm:{to:this.ecomOrder,td:this.ecomDetailArr}}};a.d.f=escape(a.d.f);a.d.r=escape(a.d.r);this.$log.log("sendEcomMeta "+a.d.f+" requestURL:"+c);a.d=$elj.toJSON(a.d);this.activeRequest=$elj.ajax({url:c,data:a,dataType:"json",contentType:"text/plain; charset=utf-8",type:"POST",success:$elj.proxy(this.handleEcomMetaResult,this),error:function(d){b.$log.log("error sending meta"+d.message)},crossDomain:true,cache:false});this.ecomOrder=[];this.ecomDetailArr=[]},handleEcomMetaResult:function(a){this.$log.log("handleGoalMetaResult: "+(a!==undefined&&a!==null?a.r:"error"));this.activeRequest=null},getMeta:function(a){return $elj('meta[name="'+a+'"]').attr("content")}})})();(function(){var a={selectedIndex:-1,curResponse:null,catArr:[],view:null,$activeHoverElement:null,$clickableElements:[],linkClickEvent:null,$log:new $elc.util.ClassLog("ctrl.result",true),showLoadingResultsDelay:0,init:function(){var b=this;if($elc.config.get("hasResultsSide")){b.view=new $elc.classes.ViewResultSide()}else{b.view=new $elc.classes.ViewResult()}b.bindEvents()},bindEvents:function(c){var b=this;if(c===undefined){c=true}$elj(b.view).unbind($elc.enums.EventType.ViewRenderComplete);$elj(window).unbind("resize",$elj.proxy(b.handleWindowResize,b));if(c){$elj(b.view).bind($elc.enums.EventType.ViewRenderComplete,$elj.proxy(b.handleRenderComplete,b));$elj(window).bind("resize",$elj.proxy(b.handleWindowResize,b))}},handleQueryResponse:function(c){var b=this;b.catArr=c.d.catArr;b.curResponse=c.d;b.refresh();if(c.onResponseSelectFirstResult&&!$elc.config.get("isMobile")&&b.$activeHoverElement===null){b.resultSelectStepInc(true)}},refresh:function(){var b=this;b.view.refresh(b.curResponse);b.handleWindowResize()},reset:function(){var b=this;b.$activeHoverElement=null;b.$clickableElements=[];b.curResponse=null;b.view.reset()},handleRenderComplete:function(b){if(!b.isSameAsLastReponse){this.bindResultMouseEvents()}var c=this;setTimeout(function(){c.handleWindowResize()},0);$elj(this).trigger(b)},bindResultMouseEvents:function(){this.$clickableElements=[];this.$activeHoverElement=null;var d=this.view.$wrap.find("."+$elc.enums.CSSType.isClickable),c=this,b;d.each(function(e,f){b=$elj(f);c.bindResultMouseEventItem(b);c.$clickableElements.push(b);b.data("clickableIndex",c.$clickableElements.length-1)});d=this.view.$wrap.find("a");d.each(function(e,f){b=$elj(f);b.bind("click",$elj.proxy(c.handleResultInnerLinkClick,c))})},bindResultMouseEventItem:function(b){var c=this;b.unbind("mouseover").unbind("mouseover").unbind("click").bind("mouseover",function(){c.resultSelectItem(b,true)}).bind("mouseout",function(){c.resultSelectItem(b,false)}).bind("click",$elj.proxy(c.handleResultClick,this))},resultSelectItem:function(b,c){if(c){if(this.$activeHoverElement){this.resultSelectItem(this.$activeHoverElement,false)}b.addClass($elc.enums.CSSType.hover);this.$activeHoverElement=b;$elc.app.state.set("isResultSelected",true)}else{this.$activeHoverElement=null;b.removeClass($elc.enums.CSSType.hover);$elc.app.state.set("isResultSelected",false)}},handleResultClick:function(b){$elc.app.state.set("isVisitInProgress",true);var c=this;setTimeout(function(){c.handleResultClickProcess(b)},100)},handleResultInnerLinkClick:function(b){this.linkClickEvent=b;try{b.preventDefault()}catch(c){}},handleResultClickProcess:function(d){try{d.preventDefault();d.stopPropagation();d.stopImmediatePropagation()}catch(f){}var l=$elj(d.target).closest("."+$elc.enums.CSSType.isClickable),k,r,p,n,o,q,i,b,j,h,g;if(l.length===0){return}l=l[0];k=$elj.data(l,"type");q=null;j=this.curResponse.catArr.length>0;switch(k){case $elc.enums.ResultType.Match:i=$elj.data(l,"match");b=$elj.data(l,"cat");r=i.k;p=i.u;o="";n=i.n;if(this.linkClickEvent!==null){p=this.linkClickEvent.target.href;o=$elj(this.linkClickEvent.target).text();if(this.linkClickEvent.target.target!="_parent"){if(p.indexOf("?")>-1){p+="&target="+this.linkClickEvent.target.target}else{p+="?target="+this.linkClickEvent.target.target}}this.$log.log('url reassigned:"'+p+'"')}q=new $elc.classes.EventVisit($elc.enums.EventType.VisitResult,p,b.c,n,r,this.curResponse.i,j,false,false,o);break;case $elc.enums.ResultType.Category:b=$elj.data(l,"cat");q=new $elc.classes.EventVisit($elc.enums.EventType.VisitResult,b.u,b.c,b.c,b.c,this.curResponse.i,j,false,false);break;case $elc.enums.ResultType.ShowingResultsFor:h=$elj.data(l,"label");g=new $elc.classes.EventInput($elc.enums.EventType.InputSet,h);this.handleSelfTrigger(g);break;case $elc.enums.ResultType.MoreResults:case $elc.enums.ResultType.NoResults:q=new $elc.classes.EventVisit($elc.enums.EventType.VisitSearchAll,"","","",this.curResponse.i,this.curResponse.i,j,true,false);break}if(q){this.handleSelfTrigger(q)}return false},handleInputNav:function(d){this.$log.log("handleInputNav e.key:"+d.key);var b=this,f=false,c="",g;switch(d.key){case $elc.enums.KeyType.Down:if(d.isInputFillWithHint===undefined){b.resultSelectStepInc()}else{if(d.isInputFillWithHint&&b.$activeHoverElement===null){b.resultSelectStepInc()}}b.refreshScrollableTop();break;case $elc.enums.KeyType.Up:b.resultSelectStepDec();b.refreshScrollableTop();break;case $elc.enums.KeyType.Enter:if(b.$activeHoverElement!==null){b.$activeHoverElement.trigger("click")}else{if(b.curResponse&&b.curResponse.catArr.length===0){b.$log.log("curResponse empty, triggering submit");d.key=$elc.enums.KeyType.Submit;b.handleInputNav(d);return}else{b.resultSelectStepInc();b.handleSelfTrigger(d)}}break;case $elc.enums.KeyType.Submit:if(b.curResponse){f=b.curResponse.catArr.length>0;c=b.curResponse.i}if(d.input!==undefined){c=d.input}g=new $elc.classes.EventVisit($elc.enums.EventType.VisitSearchAll,"","","",c,c,f,false,true);b.handleSelfTrigger(g);break}},handleSelfTrigger:function(b){$elj(this).trigger(b)},resultSelectStepInc:function(b){this.$log.log("resultSelectStepInc:");if(b===undefined){b=true}var d=0,e,c,f;if(this.$activeHoverElement!==null){d=$elj.data(this.$activeHoverElement[0],"clickableIndex")+1}if(b){for(e=d;e<this.$clickableElements.length;e+=1){c=this.$clickableElements[e];f=$elj.data(c[0],"type");if(f==$elc.enums.ResultType.Match){d=e;break}}}if(d>=this.$clickableElements.length){return}else{this.resultSelectItem(this.$clickableElements[d],true)}},resultSelectStepDec:function(b){if(b===undefined){b=true}if(this.$activeHoverElement===null){return}else{var d=$elj.data(this.$activeHoverElement[0],"clickableIndex")-1,e,c,f;if(b){for(e=d;e>=0;e-=1){c=this.$clickableElements[e];f=$elj.data(c[0],"type");if(f==$elc.enums.ResultType.Match){d=e;break}else{if(d===0){d=1;break}}}}if(d>=0){this.resultSelectItem(this.$clickableElements[d],true)}}},handleWindowResize:function(){this.refreshScrollableContent()},refreshScrollableContent:function(){if($elc.config.get("useFixedScrollableResults")&&!$elc.config.get("isMobile")){var b,d,c;this.view.$wrap.removeClass("elc-scrollable");this.view.$wrap.css({height:"auto",width:""});b=$elj(window).height();if(!$elc.config.get("isMobile")){b-=this.view.$wrap.offset().top-$elj(window).scrollTop()+10}c=this.view.$wrap.width();d=this.view.$wrap.height();if(b<d){this.view.$wrap.addClass("elc-scrollable");if(!$elc.config.get("isMobile")){c+=$elc.util.getScrollBarWidth();this.view.$wrap.height(b);this.view.$wrap.width(c)}}this.refreshScrollableTop()}},refreshScrollableTop:function(){if($elc.config.get("useFixedScrollableResults")){if(this.$activeHoverElement!==null){var b,e,c,d,f;b=this.$activeHoverElement.offsetRelativeTo(this.view.$wrap);e=b.top;if(e<this.view.$wrap.scrollTop()){if(this.$activeHoverElement.data("clickableIndex")===0){e=0}this.view.$wrap.scrollTop(e)}c=b.top+this.$activeHoverElement.outerHeight();d=c-(this.view.$wrap.innerHeight()+this.view.$wrap.scrollTop());if(d>0){f=c-this.view.$wrap.innerHeight();this.view.$wrap.scrollTop(f)}}}},getIsOpen:function(){return this.view.getIsOpen()},hasResults:function(){var b=this,c=false;if(b.curResponse!==null){if(b.curResponse.catArr!==null&&b.curResponse.catArr.length>0&&!b.curResponse.isLoadingResults){c=true}}return c},toggleLoadingResult:function(c){var b=this;setTimeout(function(){if(c&&!b.hasResults()){b.curResponse=new $elc.classes.ModelResult({},true);b.refresh()}},b.showLoadingResultsDelay)}};$elc.classes.ControllerResult=$elc.util.Class.extend(a)})();(function(){var a={$form:null,$clientSearchWrapper:null,$searchWrapper:null,wasItemClicked:false,input:null,result:null,blurDelay_id:-1,lastTouchEvent:null,addClassesToSearchWrapper:"",isSearchWrapperCollapseable:false,isSearchWrapperOpenOnStart:true,isSearchWrapperOpen:true,addAfterSearchWrapper:"",$log:new $elc.util.ClassLog("ctrl.ui",true),init:function(){var b=this;b.$log.log("ui init");if(!$elc.config.get("allowIE6")&&$elc.util.isIE6()){return}$elj("html").addClass($elc.config.get("pageType"));b.decorateSearchWrapper();b.input=new $elc.classes.ControllerInput(this.$searchWrapper);b.result=new $elc.classes.ControllerResult()},decorateSearchWrapper:function(){var b=this;if($elc.config.get("injectSearchWrapper")!==null){try{$elc.config.get("injectSearchWrapper")($elj)}catch(c){$elc.log("injectSearchWrapper error:"+c)}}b.isSearchWrapperCollapseable=$elc.config.get("isSearchWrapperCollapseable");b.isSearchWrapperOpenOnStart=$elc.config.get("isSearchWrapperOpenOnStart");b.isSearchWrapperOpen=b.isSearchWrapperOpenOnStart;b.addSearchWrapper();b.$form=$elj($elc.config.get("searchFormSelector"));b.$form.addClass("elc-form")},addSearchWrapper:function(){var d=this,j,b,c,f,h,g,e;j='<span class="elc-searchWrapper ';j+=this.addClassesToSearchWrapper;j+='"></span>';b=$elj($elc.config.get("clientSearchInputFieldSelector"));c=$elj($elc.config.get("clientSearchInputButtonSelector"));$elc.config.set("isClientInputBoxFocusedOnStart",b.is(":focus"));document.documentElement.className+=" elc-enabled ";b.wrap(j);b.after(c);d.$searchWrapper=b.closest(".elc-searchWrapper");if(d.addAfterSearchWrapper!==""){d.$searchWrapper.after($elj(d.addAfterSearchWrapper))}if(d.isSearchWrapperCollapseable&&!d.isSearchWrapperOpenOnStart){d.$searchWrapper.stop(true).slideToggle(0)}if(b.length>0){f=b[0].className.split(/\s+/);h="";for(g=0;g<f.length;g+=1){e=f[g];if(e.indexOf("elc-style")>-1){h=e;break}}if(h!==""){d.$searchWrapper.addClass(h)}}d.$log.log("searchwrapper done")},startup:function(){this.bindEvents();this.handleWindowResize()},bindEvents:function(c){var b=this;if(c===undefined){c=true}$elj(b.input).unbind($elc.enums.EventType.Query).unbind($elc.enums.EventType.ViewResultClose).unbind($elc.enums.EventType.InputNav).unbind($elc.enums.EventType.Input).unbind($elc.enums.EventType.SearchClose);$elj(b.result).unbind($elc.enums.EventType.Visit).unbind($elc.enums.EventType.Input);b.$searchWrapper.unbind("mouseover",$elj.proxy(b.handleSearchWrapperOver,b)).unbind("mouseout",$elj.proxy(b.handleSearchWrapperOut,b));$elj(document).unbind("click",$elj.proxy(b.handleDocumentClick,b)).unbind("mousedown",$elj.proxy(b.handleDocumentMouseDown,b)).unbind("mouseup",$elj.proxy(b.handleDocumentMouseUp,b));$elj(window).unbind("resize",$elj.proxy(b.handleWindowResize,b)).unbind("unload",$elj.proxy(b.handleWindowUnload,b)).unbind("load",$elj.proxy(b.handleWindowLoad,b));if(c){$elj(b.input).bind($elc.enums.EventType.QuerySend,$elj.proxy(b.handleQuerySend,b)).bind($elc.enums.EventType.QueryCancel,$elj.proxy(b.handleSelfTrigger,b)).bind($elc.enums.EventType.ViewResultClose,$elj.proxy(b.handleCloseResult,b)).bind($elc.enums.EventType.InputNav,function(d){b.result.handleInputNav(d)}).bind($elc.enums.EventType.SearchClose,$elj.proxy(b.handleSelfTrigger,b)).bind($elc.enums.EventType.InputFocus,$elj.proxy(b.handleInputFocus,b)).bind($elc.enums.EventType.InputBlur,$elj.proxy(b.handleInputBlur,b));b.$searchWrapper.bind("mouseover",$elj.proxy(b.handleSearchWrapperOver,b)).bind("mouseout",$elj.proxy(b.handleSearchWrapperOut,b));$elj(b.result).bind($elc.enums.EventType.VisitResult,$elj.proxy(b.handleVisit,b)).bind($elc.enums.EventType.VisitSearchAll,$elj.proxy(b.handleVisit,b)).bind($elc.enums.EventType.InputNav,function(d){if(d.key==$elc.enums.KeyType.Enter){b.input.fillInputWithHint()}}).bind($elc.enums.EventType.InputSet,$elj.proxy(b.input.handleInputSet,b.input)).bind($elc.enums.EventType.ViewRenderComplete,$elj.proxy(b.handleResultsRenderComplete,b));$elj(document).bind("click",$elj.proxy(b.handleDocumentClick,b)).bind("mousedown",$elj.proxy(b.handleDocumentMouseDown,b)).bind("mouseup",$elj.proxy(b.handleDocumentMouseUp,b));$elj(window).bind("resize",$elj.proxy(b.handleWindowResize,b)).bind("unload",$elj.proxy(b.handleWindowUnload,b)).bind("load",$elj.proxy(b.handleWindowLoad,b));if(!$elc.config.get("isMobile")&&$elc.util.isiTouch()){$elc.util.bindiTouchEvents(document)}}},handleVisit:function(c){var b=this;if($elc.util.isiTouch()){setTimeout(function(){b.handleWindowUnload()},0)}b.handleSelfTrigger(c)},handleQuerySend:function(b){this.$log.log("handleQuerySend");this.handleSelfTrigger(b)},handleResultsRenderComplete:function(){},handleSelfTrigger:function(b){$elj(this).trigger(b)},handleCloseResult:function(){this.$log.log("handleCloseResult");this.resetViews()},handleQueryResponse:function(b){var c=this.input.handleQueryResponse(b);if(c){this.result.handleQueryResponse(b)}return c},resetViews:function(){this.result.reset()},handleDocumentClick:function(b){var d,f,c;d=$elc.app.state.isMobile();if(d){return}f=b.target||b.srcElement||b.originalTarget;if(f!==undefined&&f!==null){c=$elj(f).parents(".elc-searchWrapper").length===0;this.$log.log("isClickoutside:"+c+" result.isOpen:"+this.result.getIsOpen());if(c&&!$elc.config.get("isResultViewCloseBypassed")&&this.result.getIsOpen()){this.$log.log("close results from document click");this.input.handleEscape(undefined,undefined,this.result.getIsOpen(),true)}}},handleDocumentMouseDown:function(){$elj(document).data("isMouseDown",true)},handleDocumentMouseUp:function(){$elj(document).data("isMouseDown",false)},handleWindowResize:function(){},handleWindowUnload:function(){this.$log.log("handleWindowUnload");$elc.app.state.set("isUnloadInProgress",true);this.input.handleEscape(undefined,undefined,false)},handleWindowLoad:function(){},triggerSubmit:function(){this.$log.log("-->ui controlelr submit");this.input.triggerSubmit()},handleSearchWrapperOver:function(){this.$searchWrapper.addClass("elc-searchWrapper-hover")},handleSearchWrapperOut:function(){this.$searchWrapper.removeClass("elc-searchWrapper-hover")},searchWrapperInputFocusTimeout_id:-1,toggleSearchWrapper:function(){if(!this.isSearchWrapperCollapseable){return}this.$log.log("toggleSearchWrapper:"+this+" this.isSearchWrapperOpen:"+this.isSearchWrapperOpen+" isSearchWrapperCollapseable:"+this.isSearchWrapperCollapseable);var c=this,d=this.$searchWrapper.parent().width()+"px",b=$elj($elc.config.get("elcSearchInputFieldSelector"));this.$searchWrapper.css("width",d);clearTimeout(this.searchWrapperInputFocusTimeout_id);if(this.isSearchWrapperOpen){b.blur();this.$searchWrapper.stop(true).slideUp("medium",function(){c.$searchWrapper.css("width","auto")});this.isSearchWrapperOpen=false}else{this.$searchWrapper.stop(true).slideDown(0,function(){c.$searchWrapper.css("width","auto")});this.input.handleVisible();this.isSearchWrapperOpen=true;b.focus()}},handleInputFocus:function(){var b=1;b+=1},handleInputBlur:function(){var b=1;b+=1},toString:function(){return"UI Controller"}};$elc.classes.ControllerUI=$elc.util.Class.extend(a)})();(function(){var a={$log:new $elc.util.ClassLog("ctrl.visit",true),init:function(){var b=1;b+=1},handleVisitResult:function(c){$elc.log("handleVisitResult:"+c);var h=$elj.trim(c.url),g=true,f=false,b=this,d=h.toLowerCase().indexOf("javascript:")===0;if($elc.util.stringIsNullOrEmpty(h)){h=""}if(!d){h=b.appendQueryStringOptions(h,c);h=b.appendQueryStringSiteSearch(h,c);if(h.indexOf("target=_blank")>0){f=true;g=false}if($elc.config.get("isFacebook")){g=true}if(h.indexOf("http")!==0&&h.charAt(0)!="/"){h=document.location.protocol+"//"+h}}$elc.log("visiting link "+h+" isTargetBlank:"+f);if(g){window.open(h,"_top")}else{if(f){window.open(h)}else{setTimeout(function(){window.location.assign(h)},1)}}},goToURL:function(c){var b=document.createElement("a");if(b.click){b.setAttribute("href",c);b.style.display="none";document.body.appendChild(b);b.click()}else{window.location=c}},appendQueryStringOptions:function(d,b){var c=$elc.config.get("appendToQueryStringToEndOfAllLinks");if(!$elc.util.stringIsNullOrEmpty(c)){d=this.appendValuesToQueryString(c,d)}return d},appendQueryStringSiteSearch:function(d,b){if($elc.config.get("isSiteSearchVisitUrlAppendEnabled")){var c={};c[$elc.config.get("siteSearchVisitTermTag")]=escape(b.keyword);c[$elc.config.get("siteSearchVisitCategoryTag")]=escape(b.category);d=this.appendValuesToQueryString(c,d)}return d},appendValuesToQueryString:function(e,f){var c,h,b,d,g=true;if(f!==undefined){if(f.toLowerCase().indexOf("javascript:")===0){return}if(f.indexOf("#")>-1){d=f.split("#");b=d[1];f=d[0]}if(f.indexOf("?")==-1){f+="?";g=false}if(e!==undefined&&e!==null){if(typeof e=="string"){f+=e}else{if(typeof e=="object"){for(c in e){h=e[c];if(g){f+="&"}g=true;f+=c+"="+h}}}}if(b!==undefined){f+="#"+b}}return f},handleVisitSearchAll:function(b){$elj(this).trigger(b)}};$elc.classes.ControllerVisit=$elc.util.Class.extend(a)})();$elc.classes.ModelMatch=(function(c,b){var f=this,e,a,h,g;f._category=b;$elj.extend(f,c);f.hasTracking=false;f._imgThumb="";f._d=c.d;if(c!==undefined&&c!==null){if($elc.config.trackingMap){for(e=0;e<$elc.config.get("trackingMap").length;e+=1){a=$elc.config.get("trackingMap")[e];if(a==f.c){f.hasTracking=true}}g="site_"+$elc.config.get("site").toLowerCase();for(e=0;e<$elc.config.get("trackingMap").length;e+=1){h=$elc.config.get("trackingMap")[e];if(h.id.toLower()==g){f.hasTracking=true}}}}f.fixImagePath=function(){var m=f.i,n,l=false,k,j;if(m!==""&&m!==undefined){if(m.indexOf("http://")>-1){m=m.substring(7,m.length)}else{if(m.indexOf("https://")>-1){m=m.substring(8,m.length)}else{if(m.charAt(0)=="/"){m=m.substring(1,m.length)}m=$elc.config.get("imgBasePath")+m}}try{k=m.split(".");if(k.length>0){j=k[k.length-1].toLowerCase();if(j=="jpg"||j=="jpeg"||j=="png"||j=="gif"){l=true}}}catch(d){}}if(m===""||m===undefined||m===null||!l){m=$elc.config.get("imgBlankPath");f._imgThumbBlank=true}n=$elc.config.get("protocol")+m;if($elc.config.get("imgBasePath")===undefined||m===undefined){n=undefined}f._imgThumb=n};f.isEqual=function(d){var i=false;if(f.n==d.n&&f._d==d._d&&f._imgThumb==d._imgThumb){i=true}return i};f.fixImagePath()});$elc.classes.ModelResult=(function(a,b){var c=this;$elj.extend(c,a);c.catArr=[];c.isLoadingResults=b;if(c.u===undefined){c.u=""}c.areResultsEqual=function(g){var j=false,k=true,d,e,f,h;if(!g.srf&&!c.srf){k=true}else{if((g.srf&&!c.srf)||(!g.srf&&c.srf)){k=false}else{if(g.srf!=c.srf){k=false}}}if(k){if(g&&c.catArr&&g.catArr&&c.catArr.length==g.catArr.length){d=true;for(h=0;h<c.catArr.length;h+=1){e=c.catArr[h];f=g.catArr[h];d=e.isEqual(f);if(!d){j=false;break}}if(d){j=true}}}return j};c.toString=function(){return"ResultData "+c.i}});$elc.classes.ModelCategory=(function(a){var d=this,b,c;$elj.extend(d,a);d.data=a;d.matchesArr=[];if(a!==undefined&&a!==null){if(a.rs){for(b=0;b<a.rs.length;b+=1){c=new $elc.classes.ModelMatch(a.rs[b],this);d.matchesArr.push(c)}}}d.isEqual=function(f){var k=false,h=null,j=null,e=true,g;if(d.c==f.c){if(d.matchesArr&&f.matchesArr&&d.matchesArr.length==f.matchesArr.length){for(g=0;g<d.matchesArr.length;g+=1){h=d.matchesArr[g];j=f.matchesArr[g];e=h.isEqual(j);if(!e){k=false;break}}if(e){k=true}}}return k}});$elc.classes.ModelEcomOrder=(function(f,c,d,i,j,g,b,h,a){var e=this;e.oi=f||"";e.l1=c||"";e.l2=d||"";e.tt=i||"";e.tx=j||"";e.sh=g||"";e.ct=b||"";e.st=h||"";e.cn=a||"";return e});$elc.classes.ModelEcomDetail=(function(d,g,e,a,b,h,f){var c=this;c.oi=d||"";c.sk=g||"";c.pn=e||"";c.l1=a||"";c.l2=b||"";c.up=h||"";c.qt=f||"";return c});(function(){var a={$log:new $elc.util.ClassLog("view.templates",false),templates:{},defaults:{resultsWrapperTag:'<span class="elc-resultsWrapper <%= this._css %>"></span>',resultsTag:'<ul class="elc-results"></ul>',resultsSideTag:'<ul class="elc-resultsSide"></ul>',resultSide_displayTypes:["8"],resultBottom_displayTypes:["7"],resultTop_displayTypes:[],displayType_cat:'<li class="<%= this._outerCss %>" data-url="<%= this.u %>"><div class="elc-category <%= this._css %>"><span class="elc-category-inner"><span class="elc-category-text"><%= this.c %></span></span></div></li>',displayType_0:"",displayType_allowTitleSubVerticalIsolation:false,displayType_1:'<li class="<%= this._outerCss %>" data-url="<%= this.u %>"><div class="elc-match <%= this._css %>"><table class="elc-matchTable "><tr><td class="elc-matchImgCell" rowspan="2"><div class="elc-matchImgOuter elc-matchImgDefaultThumb"><img class="elc-matchImg" src="<%= this._imgThumb %>" alt=""\\></div></td><td class="elc-matchTitleCell"><span class="elc-matchTitle"><%= this.n %></span></td><% if ((this.pn != undefined && this.pn != 0) || this.pl != undefined || this.pl2 != undefined || this.cmf != undefined){ this._hasTitleSub = true; } %><% if (this._hasTitleSub == true){ %><% this._titleSubHasVerticalIsolation = $elc.config.get(\'displayType_allowTitleSubVerticalIsolation\'); %><td class="elc-matchTitleSubCell <%= this._titleSubHasVerticalIsolation ? \'elc-fullcol\' : \'\' %>" rowspan="<%= this._titleSubHasVerticalIsolation ? 2 : 1 %>"><span class="elc-matchTitleSub"><% if (this.pn != undefined && this.pn != 0) { %><span class="elc-matchTitleSubItem"><% if (this.pp != undefined){ %><%= this.pp %><% } %><%= this.pn %></span><br/><% }%><% if (this.pl != undefined ) { %><span class="elc-matchTitleSubItem"><%= this.pl %></span><br/><% } %><% if (this.pl2 != undefined ) { %><span class="elc-matchTitleSubItem"><%= this.pl2 %></span><br/><% } %><% if (this.cmf != undefined){ %><span class="elc-matchTitleSubItem"><% if (this.cmf.cta_url != undefined){ %><a href="<%= this.cmf.cta_url %>" <% if (this.cmf.cta_target != undefined){%> target="<%=this.cmf.cta_target%><%}}%>"><% if (this.cmf.cta_label != undefined) { %><%=this.cmf.cta_label%><% } %><% if (this.cmf.cta_url != undefined) { %></a><% } %></span><br/><% } %></span></td><% } %></td></tr><% this._descColspan = this._hasTitleSub && !this._titleSubHasVerticalIsolation? 2 : 1; %><tr><td colspan="<%=this._descColspan%>" class="elc-matchDescCell"><div class="elc-matchDesc" ><%= this.d %></div></div></td></tr></tr></table></div></li>',displayType_2:'<li class="<%= this._outerCss %>" data-url="<%= this.u %>"><div class="elc-match <%= this._css %>"><div class="elc-match-text"><div class="elc-matchTitle"><%= this.n %></div><div class="elc-matchDesc"><%= this.d %></div></div></div></li>',displayType_3:'<li class="<%= this._outerCss %>" data-url="<%= this.u %>"><div class="elc-match <%= this._css %>"><div class="elc-match-halfHeightText"><div class="elc-matchDesc"><%= this.d %></div></div></div></li>',displayType_4:'<li class="<%= this._outerCss %>" data-url="<%= this.u %>"><div class="elc-match elc-match-rich <%= this._css %>"><img class="elc-matchCoverImg" title="<%= this._alt %>" alt="<%= this._alt %>" src="<%= this._imgBlank %>"\\><div class="elc-match-richFullHeight elc-match-rich-inner"><img src="<%= this._imgThumb %>" class="elc-pngfix elc-rich-img" alt=""\\></div></div></li>',displayType_5:'<li class="<%= this._outerCss %>" data-url="<%= this.u %>"><div class="elc-match elc-match-rich <%= this._css %>"><img class="elc-matchCoverImg" title="<%= this._alt %>" alt="<%= this._alt %>" src="<%= this._imgBlank %>"\\><div class="elc-match-richDoubleHeight elc-match-rich-inner"><img src="<%= this._imgThumb %>" class="elc-pngfix elc-rich-mg" alt=""\\></div></div></li>',displayType_6:'<li class="<%= this._outerCss %>" data-url="<%= this.u %>"><div class="elc-match elc-match-rich <%= this._css %>"><img class="elc-matchCoverImg" title="<%= this._alt %>" alt="<%= this._alt %>" src="<%= this._imgBlank %>"\\><div class="elc-match-richHalfHeight elc-match-rich-inner"><img src="<%= this._imgThumb %>" class="elc-pngfix elc-rich-img" alt=""\\></div></div></li>',displayType_7:'<div class="elc-resultItem-footer <%= this._outerCss %>" data-url="<%= this.u %>"><div class="elc-match <%= this._css %>"><div class="elc-match-singleHeightText"><div class="elc-matchDesc"><%= this.d %></div></div></div></div>',displayType_8:'<li class="<%= this._outerCss %>" data-url="<%= this.u %>"><div class="elc-match elc-match-rich <%= this._css %>"><img class="elc-matchCoverImg" title="<%= this._alt %>" alt="<%= this._alt %>" src="<%= this._imgBlank %>"\\><div class="elc-match-richFullHeight elc-match-rich-inner"><img src="<%= this._imgThumb %>" class="elc-pngfix elc-rich-img" alt=""\\></div></div></li>',displayType_moreResults:'<li class="elc-moreResultsOuter <%= this._outerCss %>"><div class="elc-moreResults "><span class="elc-moreResults-inner"><%= this.s %></span></div></li>',displayType_noResults:'<li class="elc-noResultsOuter <%= this._outerCss %>"><div class="elc-noResults <%= this._css %>"><span class="elc-noResults-inner"><%= this.s %></span></div></li>',displayType_showingResults:'<li class="elc-showingResultsOuter <%= this._outerCss %>"><div class="elc-showingResults <%= this._css %>"><span class="elc-showingResults-inner"><%= this.s %></span></div></li>',displayType_loadingResults:'<li class="elc-loadingResultsOuter <%= this._outerCss %>"><div class="elc-loadingResults <%= this._css %>"><span class="elc-loadingResults-inner"><%= this.s %></span></div></li>'},init:function(){this.templates=$elj.extend(true,{},this.defaults,$elc.config.get("templateOverrides"));this.overwriteFromConfig();this.transform()},transform:function(){this.templates.displayType_0=this.templates.displayType_1},overwriteFromConfig:function(){var d,b,c,e;d=$elc.config.getKeysStartingWith("displayType_");for(b=0;b<d.length;b+=1){c=this.templateArr[b];e=$elc.config.get(c);this.templates[c]=e}},get:function(b){return this.templates[b]}};$elc.classes.ViewTemplates=$elc.util.Class.extend(a)})();(function(){var a={$form:null,$clientInputBox:null,$inputbox:null,$clientSubmitBtn:null,$submitBtn:null,$log:new $elc.util.ClassLog("view.input",true),init:function(){},startup:function(){var b=this;b.$form=$elj($elc.config.get("searchFormSelector"));b.$clientInputBox=$elj($elc.config.get("clientSearchInputFieldSelector"));b.$clientSubmitBtn=$elj($elc.config.get("clientSearchInputButtonSelector"));b.decorate()},decorate:function(){var c,b=this;b.$form.attr("autocomplete","off");if(b.$clientInputBox.length>0){c=$elj($elc.config.get("elcSearchInputFieldSelector"));if($elc.config.get("clientSearchInputFieldSelector")==$elc.config.get("elcSearchInputFieldSelector")||(c.length>0&&b.$clientInputBox[0]==c[0])){b.$inputbox=b.$clientInputBox}else{b.muteClientInput();b.$inputbox=$elj('<input type="text" class="elc-searchInput" autocomplete="off" />');b.$inputbox.insertAfter(b.$clientInputBox);setTimeout(function(){},500)}}else{b.$inputbox=$elj($elc.config.get("elcSearchInputFieldSelector"))}if($elc.config.get("clientSearchInputButtonSelector")==$elc.config.get("elcSearchInputButtonSelector")){b.$submitBtn=b.$clientSubmitBtn}else{b.$clientSubmitBtn.addClass("elc-searchBtn");b.$submitBtn=$elj($elc.config.get("elcSearchInputButtonSelector"))}b.$inputbox.addClass("elc-searchInput").attr("autocomplete","off").attr("autocorrect","off").attr("autocapitalize","off").attr("spellcheck","false").attr("maxlength","50").attr("disableLegacyInputChecking","true").attr("title",$elc.config.get("defaultSearchInputText"));b.$inputbox.wrap('<span class="elc-search"></span>');b.$inputbox.after(b.$submitBtn);$elj(".elc-hint-container").addClass($elc.enums.CSSType.CSS3Fix);$elc.util.fixCSS3()},muteClientInput:function(){var b=this;b.$clientInputBox.hide();b.$clientInputBox.val("");b.$clientInputBox.bind("change",function(c){try{c.preventDefault();c.stopPropagation();c.stopImmediatePropagation()}catch(d){}return false})}};$elc.classes.ViewInput=$elc.util.Class.extend(a)})();(function(){var a={initEllipsisForDiv:function(b,d,m,r,j,l){if(r==undefined){r=""}if(j==undefined){j=false}if(j){var g,s;s=new Date()}var c=d;var t=c.text().replace(/^\s+|\s+$/g,"").split(/ +/);var p="";for(var h in t){p+="<span class='"+r+"'>"+t[h]+"</span> "}c.html(p);var e,f,o="";var k=0;c.find("span").each(function(){e=b(this);var i=e.offset();if(i.top!=f){f=i.top;k+=1;if(k>m){return false}}o+=e.text()+" "});var n=true;if(k<=m){n=false}else{o=o.substring(0,o.length-4);o+="...";c.html(o)}if(j){g=new Date();var q="Operation took "+(g.getTime()-s.getTime())+" msec   (maxlines = "+m+")";l(q)}return n},wasCSSTextOverflowApplied:function(b){var c=b.clone().css({display:"inline",width:"auto",visibility:"hidden"}).appendTo("body"),d=false;if(c.width()>b.width()){d=true}c.remove();return d}};$elc.classes.ViewEllipses=$elc.util.Class.extend(a)})();(function(){var a={$wrap:null,curResponse:null,prevResponse:null,templateArr:null,catArr:null,templates:null,isOpen:false,ellipses:null,$list:null,$prevList:null,doResultsRenderChunkWithDelay:false,doHideResultsPreRender:true,curRenderCatIndex:0,curRenderMatchIndex:0,curRenderMatchTotal:0,renderChunkTimeoutId:-1,$chunkList:null,renderChunkTime:0,renderStartTime:0,$log:new $elc.util.ClassLog("view.result",true),firstMatch:true,init:function(){var b=this;b.ellipses=new $elc.classes.ViewEllipses();b.templates=$elc.app.templates;if($elc.util.isMobile()||$elc.util.isIELess10()){b.doResultsRenderChunkWithDelay=true}b.setupWrapper()},setupWrapper:function(){var c=this,e,f,b;e={_css:""};e._css+=$elc.config.get("resultsLayoutType")+" ";f=$elj.jqote(c.templates.get("resultsWrapperTag"),e);c.$wrap=$elj(f);if($elc.config.get("versionFull")==5&&$elc.config.get("versionMinor")===0&&$elc.config.get("versionRev")<14){c.$wrap=$elj(c.templates.get("resultsWrapperTag"))}c.$wrap.addClass("elc-hidden").addClass($elc.enums.CSSType.CSS3Fix);b=$elj(".elc-search");b.after(c.$wrap);b.after($elj("<div class='elc-clearBoth'></div>"))},reset:function(){if(this.$wrap){this.$wrap.empty()}this.$wrap.addClass("elc-hidden");this.isOpen=false;this.curResponse=null;$elc.util.fixCSS3()},refreshForce:function(){if(!this.isOpen){return}var b=this.prevResponse;this.prevResponse=null,this.refresh(b)},refresh:function(c){var b=this;if(c!==undefined&&c!==null){b.curResponse=c}if(b.curResponse===null){return}else{if(b.curResponse.i&&b.curResponse.i==="no results please"){b.curResponse.catArr=[]}}if($elc.config.get("showNoResults")!==undefined){if(b.curResponse.catArr.length===0&&!$elc.config.get("showNoResults")){b.reset();return}}b.renderStartTime=b.$log.log("==render start");if(b.isOpen&&b.prevResponse&&b.curResponse&&b.prevResponse.areResultsEqual(b.curResponse)){b.triggerRenderCompleteEvent(true);return}b.prevResponse=b.curResponse;b.$wrap.removeClass("elc-hidden");if(b.$wrap.html()===""&&b.doHideResultsPreRender){b.$wrap.addClass("elc-prerender")}b.renderResultsPrepare();b.renderResultsStart();b.isOpen=true},renderResultsPrepare:function(){var b=this;b.$log.log("renderResults for input:"+b.curResponse.i+", clearing renderChunkTimeoutId:"+b.renderChunkTimeoutId);clearTimeout(b.renderChunkTimeoutId);b.renderChunkTimeoutId=-1;if(b.$chunkList!==null){b.$chunkList=null;b.$list=b.$prevList}b.$prevList=b.$list;b.$list=$elj(b.templates.get("resultsTag"));if(b.doHideResultsPreRender){b.$list.addClass("elc-prerender")}else{if(b.$prevList){b.$prevList.remove()}b.$wrap.empty()}b.$wrap.removeClass("elc-bg-transparent");b.$wrap.empty();b.$wrap.append(b.$list)},renderResultsStart:function(){var d=this,e,b,c;e=d.curResponse?d.curResponse.catArr:[];if(!$elc.util.stringIsNullOrEmpty(d.curResponse.srf)){d.addShowingResultsFor(d.$list,d.curResponse.srf)}if(e.length>0){d.renderResultsChunkStart()}else{if(d.curResponse.isLoadingResults){b=d.addLoadingResults(d.$list)}else{c=d.addNoResults(d.$list)}d.renderComplete()}},renderComplete:function(){if(this.$prevList){this.$prevList.remove()}this.$chunkList=null;this.$list.removeClass("elc-prerender");this.$wrap.removeClass("elc-prerender");if(this.$wrap.html()===""){this.$wrap.addClass("elc-hidden")}else{this.$wrap.removeClass("elc-hidden")}if($elc.util.isIE6()){this.$wrap.bgiframe()}this.applyFixes();this.triggerRenderCompleteEvent()},triggerRenderCompleteEvent:function(c){if(c===undefined){c=false}var b=new $elj.Event($elc.enums.EventType.ViewRenderComplete);b.isSameAsLastReponse=c;$elj(this).trigger(b);this.$log.log("==render done",this.renderStartTime)},renderResultsChunkStart:function(){this.curRenderCatIndex=0;this.curRenderMatchIndex=0;this.curRenderMatchTotal=0;this.$chunkList=this.$list;this.renderResultsChunkNext(true)},renderResultsChunkComplete:function(){this.$log.log("renderResultsChunkComplete");this.addMoreResults(this.$list);this.$chunkList=null;this.renderComplete()},renderResultsChunkNext:function(b){var d=this.curResponse.i,c=this;if(b===undefined){b=false}if($elc.util.isMobile()||(this.doResultsRenderChunkWithDelay&&!b)){this.renderChunkTimeoutId=setTimeout($elj.proxy(function(){c.renderResultsChunk(d)},this),this.renderChunkTime)}else{this.renderResultsChunk(d)}},renderResultsChunk:function(d){var b,c,e,f;if(this.curResponse!==null&&this.curRenderCatIndex>=this.curResponse.catArr.length){this.renderResultsChunkComplete();return}if(this.curResponse===null){return}b=this.curResponse.catArr[this.curRenderCatIndex];if(this.curRenderMatchIndex===0){this.addCategory(this.$list,b)}if(this.curRenderMatchIndex>=b.matchesArr.length){this.curRenderCatIndex+=1;this.curRenderMatchIndex=0;this.renderResultsChunk(d);return}else{c=b.matchesArr[this.curRenderMatchIndex];if(c!==undefined&&c!==null){e=this.getMatchTarget(c.dt);f=this.addMatch(e,b,c)}this.curRenderMatchIndex+=1;this.curRenderMatchTotal+=1}this.renderResultsChunkNext(!f);this.applyFixes()},getMatchTarget:function(b){return this.$list},applyFixes:function(){$elc.util.fixCSS3();$elc.util.fixPng()},addCategory:function(k,c){var i,f,h,b,j;i="";f={c:c.c,_css:"",_outerCss:""};h=!$elc.util.stringIsNullOrEmpty(c.u);f._outerCss=" elc-category-outer ";if(this.curRenderCatIndex===0){f._outerCss+=" elc-category-first "}if(h){f._css+=" elc-pointer "}i=$elj.jqote(this.templates.get("displayType_cat"),f);j=true;try{if(f.c!==undefined&&($elj.inArray(f.c.toLowerCase(),$elc.config.get("hideCategoryForLabels"))>-1)){j=false}}catch(g){}if(c.d!==undefined&&c.d===0){j=false}if(j){b=$elj(i);k.append(b);b.data("cat",c);if(h){b[0].addClass($elc.enums.CSSType.isClickable)}b.data("type",$elc.enums.ResultType.Category)}return b},getDisplayTypeSafe:function(b){var f,d,g;if(!b||b===""){b=$elc.config.DisplayType.Standard}try{f=$elc.config.get("safeDisplayTypesForLayout");g=f[$elc.config.get("resultsLayoutType")];d=$elj.inArray(parseInt(b,10),g);if(d===-1){b=-1}}catch(c){}return b},addMatch:function(i,c,e){var f=e.dt,h,j=false,b,g;f=this.getDisplayTypeSafe(f);if(f==-1){return false}e._css="";e._outerCss=this.getMatchOuterDecoration();e._imgBlank=$elc.config.get("protocol")+$elc.config.get("imgBlankPath");e._alt="";if($elc.config.get("matchUsesAltTag")){if($elj.browser.mozilla){e._alt=e.n+" &#8212; "+e._d}else{e._alt=e.n+" &#13;"+e._d}}if(e._d!==undefined&&e._d!==null){if(e._d.length>$elc.config.get("matchDescTruncate")){e.d=e._d.substr(0,$elc.config.get("matchDescTruncate"));e.d=e.d.substr(0,e.d.lastIndexOf(" "))+$elc.config.get("strEllipsesHTML");j=true}}h=$elj.jqote(this.templates.get("displayType_"+e.dt),e);b=$elj(h);i.append(b);b.data("cat",c);b.data("match",e);b.data("type",$elc.enums.ResultType.Match);g=!$elc.util.stringIsNullOrEmpty(e.u);if(g){$elj(b[0]).addClass($elc.enums.CSSType.isClickable)}this.firstMatch=false;this.applyMatchPostRender(b,c,e);return j},getMatchOuterDecoration:function(){var b=" ";b+="elc-matchItem ";b+="elc-matchItem-"+(this.curRenderMatchTotal%2===0?"even":"odd")+" ";if(this.curRenderMatchTotal===0){b+="elc-match-first "}if(this.curRenderCatIndex==this.curResponse.catArr.length-1){if(this.curRenderMatchIndex==this.curResponse.catArr[this.curRenderCatIndex].matchesArr.length-1){b+="elc-match-last "}}if(this.curRenderMatchIndex===0){b+="elc-match-cat-first "}if(this.curRenderMatchIndex==this.curResponse.catArr[this.curRenderCatIndex].matchesArr.length-1){b+="elc-match-cat-last "}return b},applyMatchPostRender:function(b,c,e){this.handleMatchImages(b,e);this.adjustMatchTitleSub(b,c,e)},adjustMatchTitleSub:function(b,c,e){var f=b.find(".elc-matchTitleSubCell"),g;if(f.length>0){g=f.find(".elc-matchTitleSubItem").outerWidth();f.width(g);this.$log.log('titleSubCell.find(".elc-matchTitleSub"):'+f.find(".elc-matchTitleSub"));if($elj(f).find("br").length>1){$elj(f).addClass("elc-fullcol");$elj(f).attr("rowspan",2);$elj(f).closest(".elc-matchTable").find(".elc-matchDescCell").attr("colspan","1")}}},truncateMatchText:function(b){var c,d=false;c=$elj(b.find(".elc-matchDesc").eq(0));if(c){d=this.ellipses.initEllipsisForDiv($elj,c,2,"elc-temp-ellipsis",$elc.config.get("isLoggingEnabled"),$elc.log)}return d},matchRemoveAlt:function(b){var c=$elj(b.find(".elc-matchCoverImg").eq(0));if(c){c.attr({title:"",alt:""})}},handleMatchImages:function(b,c){b.find(".elc-matchImg").each(function(g,h){var e,d,f;e=$elj(h);d=$elj(e.parent());f=$elc.util.isIE6()||$elc.util.isMobile()?0:50;if(c._imgThumbBlank){return}if(h.complete){d.removeClass("elc-matchImgDefaultThumb");e.addClass($elc.enums.CSSType.PngFix);e.addClass($elc.enums.CSSType.CSS3Fix);$elc.util.fixCSS3();e.css("opacity",1)}else{e.css("opacity",0);e.bind("load",function(){d.removeClass("elc-matchImgDefaultThumb");e.fadeTo(f,1);e.addClass($elc.enums.CSSType.PngFix);e.addClass($elc.enums.CSSType.CSS3Fix);$elc.util.fixCSS3()})}})},addShowingResultsFor:function(c,f){var e={_outerCss:"",_css:"",s:$elc.config.get("strViewShowingResults")+' <span class="elc-underline-italic">'+f+"</span>"},b=$elj($elj.jqote(this.templates.get("displayType_showingResults"),e));c.append(b);b.data("type",$elc.enums.ResultType.ShowingResultsFor);b.data("label",f);b.addClass($elc.enums.CSSType.isClickable);return b},addMoreResults:function(c){if(!$elc.config.get("hasMoreResults")){return c}var e={_outerCss:"",_css:$elc.enums.CSSType.CSS3Fix,s:"<a>"+$elc.config.get("strViewMoreResults")+"</a>"},b=$elj($elj.jqote(this.templates.get("displayType_moreResults"),e));c.append(b);b.data("type",$elc.enums.ResultType.MoreResults);b.addClass($elc.enums.CSSType.isClickable);return b},addNoResults:function(c){var f,e,b,d;f={s:$elc.config.get("strViewResultsNoMatches"),_css:"",_outerCss:""};if(!$elc.config.get("noResultsClickable")){f._css+=" elc-noResultsOuter-noPointer "}else{f.s="<a>"+f.s+"</a>"}f._css+=" "+$elc.enums.CSSType.CSS3Fix+" ";e=$elj.jqote(this.templates.get("displayType_noResults"),f);b=$elj(e);c.append(b);b.data("type",$elc.enums.ResultType.NoResults);d=$elc.config.get("noResultsClickable");if(d){b.addClass($elc.enums.CSSType.isClickable)}return b},addLoadingResults:function(c){var d=this,f,e,b;d.$wrap.addClass("elc-bg-transparent");f={s:$elc.config.get("strViewLoadingResults"),_css:"",_outerCss:""};f._css+=" "+$elc.enums.CSSType.CSS3Fix+" ";e=$elj.jqote(d.templates.get("displayType_loadingResults"),f);b=$elj(e);c.append(b);b.data("type",$elc.enums.ResultType.LoadingResults);return b},getIsOpen:function(){return this.isOpen}};$elc.classes.ViewResult=$elc.util.Class.extend(a)})();(function(){var a={$listSide:null,$prevListSide:null,renderResultsPrepare:function(){this._super();this.$prevListSide=this.$listSide;if($elc.config.get("hasResultsSide")){this.$listSide=$elj(this.templates.get("resultsSideTag"))}if(!this.doHideResultsPreRender){if(this.$prevListSide){this.$prevListSide.remove()}}if(this.$listSide){this.$wrap.prepend(this.$listSide)}},renderComplete:function(){if(this.$prevListSide){this.$prevListSide.remove()}this.$wrap.removeClass("elc-hasSide");if(this.$listSide){if(this.$listSide.html().length>0){this.$wrap.addClass("elc-hasSide")}}this._super()},getMatchTarget:function(b){var c=this.$list;if($elj.inArray(b,this.templates.get("resultSide_displayTypes"))>-1){c=this.$listSide}else{if($elj.inArray(b,this.templates.get("resultBottom_displayTypes"))>-1){c=this.$wrap}}return c}};$elc.classes.ViewResultSide=$elc.classes.ViewResult.extend(a)})();$elc.classes.EventQuery=(function(c,f,a,h,j,k,g){var b=$elj.Event(c);b.i=f;b.d=a;b.onResponseSelectFirstResult=h;b.queryNum=j;b.refinementNum=k;b.fullEventType=c;b.isQuerySameAsHint=g;return b});$elc.classes.EventVisit=function(c,l,a,j,f,d,g,h,i,k){var b=$elj.Event(c);b.url=l;b.category=a;b.title=j,b.keyword=f;b.input=d;b.resultsFound=g;b.shiftToMoreResults=h;b.shiftToSiteSearch=i;b.fullEventType=c;b.titleSub=k;b.compare=function(e){var m=false;m=this.url==e.url&&this.category==e.category&&this.title==e.title&&this.keyword==e.keyword&&this.input==e.input&&this.resultsFound==e.resultsFound&&this.shiftToMoreResults==e.shiftToMoreResults&&this.shiftToSiteSearch==e.shiftToSiteSearch&&this.titleSub==e.titleSub;return m};return b};$elc.classes.EventInput=function(c,d,a){var b=$elj.Event(c);b.val=d;b.fullEventType=c;b.bolBypassTracking=a;return b};